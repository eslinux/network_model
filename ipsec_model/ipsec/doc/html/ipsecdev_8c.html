<html>
<head>
<title>embedded IPsec - IPsec library</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="doxygen.css" type="text/css">
</head>

<body bgcolor="#FFFFFF" text="#000000">
<table width="98%" border="0" align="center">
  <tr>
    <td>
      <h2 align="left"><img src="logo_small.gif" alt="embedded IPsec"> source 
        code documentation </h2>
<hr>

<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>ipsecdev.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
IPsec network adapter for lwIP. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Christian Scheurer &lt;<a href="http://www.christianscheurer.ch">http://www.christianscheurer.ch</a>&gt; <br>
</dd></dl>
<b>OUTLINE:</b><p>
This network interface will be inserted between the TCP/IP stack and the driver of the physical network adapter. With this, all inbound and outbound traffic can be intercepted and forwarded to the IPsec stack if required.<p>
<b>IMPLEMENTATION:</b><p>
The main duty of ipsecdev device is to identify the network traffic and forward it to the appropriate protocol handler:<p>
<ul>
<li>AH/ESP =&gt; forward to <a class="el" href="ipsec_8c.html#a0">ipsec_input()</a></li><li>IP traffic with policy BYPASS =&gt; forward to ip_input()</li><li>IP traffic with policy DISCARD, or traffic with policy APPLY but without IPsec header</li></ul>
<p>
To decide how packets must be processed, a lookup in the Security Policy Database is required. With this, all IPsec logic and IPsec related processing is put outside ipsecdev. The motivation is to separate IPsec processing from TCP/IP-Stack and network driver peculiarities. If the ipsec stack need to be ported to an other target, all major changes can be done in this module while the rest can be left untouched.<p>
<b>NOTES:</b><p>
This version of ipsecdev is able to handle traffic passed by a cs8900 driver in combination with lwIP 0.6.3 STABLE. It has a similar structure as dumpdev or cs9800if.<p>
This document is part of <em>embedded IPsec<br>
 Copyright (c) 2003 Niklaus Schild and Christian Scheurer, HTI Biel/Bienne<br>
 All rights reserved.</em><hr>

<p>
Definition in file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.
<p>
<code>#include "lwip/mem.h"</code><br>
<code>#include "<a class="el" href="ipsecdev_8h-source.html">netif/ipsecdev.h</a>"</code><br>
<code>#include "<a class="el" href="debug_8h-source.html">ipsec/debug.h</a>"</code><br>
<code>#include "<a class="el" href="ipsec_8h-source.html">ipsec/ipsec.h</a>"</code><br>
<code>#include "<a class="el" href="util_8h-source.html">ipsec/util.h</a>"</code><br>
<code>#include "<a class="el" href="sa_8h-source.html">ipsec/sa.h</a>"</code><br>

<p>
<a href="ipsecdev_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a0">IPSECDEV_NAME0</a>&nbsp;&nbsp;&nbsp;'i'</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a1">IPSECDEV_NAME1</a>&nbsp;&nbsp;&nbsp;'s'</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a11">ipsecdev_service</a> (struct netif *netif)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>err_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a12">ipsecdev_input</a> (struct pbuf *p, struct netif *inp)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>err_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a13">ipsecdev_output</a> (struct netif *netif, struct pbuf *p, struct ip_addr *ipaddr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>err_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a14">ipsecdev_netlink_output</a> (struct netif *netif, struct pbuf *p)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>err_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a15">ipsecdev_init</a> (struct netif *netif)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a16">ipsec_set_tunnel</a> (char *src, char *dst)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structsa__entry__struct.html">sad_entry</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a2">inbound_sad_config</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structspd__entry__struct.html">spd_entry</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a3">inbound_spd_config</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structsa__entry__struct.html">sad_entry</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a4">outbound_sad_config</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structspd__entry__struct.html">spd_entry</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a5">outbound_spd_config</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structdb__set__netif__struct.html">db_set_netif</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a6">db_sets</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structdb__set__netif__struct.html">db_set_netif</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a7">databases</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>netif&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a8">mapped_netif</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="types_8h.html#a4">__u32</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a9">tunnel_src_addr</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="types_8h.html#a4">__u32</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="ipsecdev_8c.html#a10">tunnel_dst_addr</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="ipsecdev.c::IPSECDEV_NAME0" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IPSECDEV_NAME0&nbsp;&nbsp;&nbsp;'i'
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
1st letter of device name "is" 
<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00079">79</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="ipsecdev.c::IPSECDEV_NAME1" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IPSECDEV_NAME1&nbsp;&nbsp;&nbsp;'s'
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
2nd letter of device name "is" 
<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00080">80</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a16" doxytag="ipsecdev.c::ipsec_set_tunnel" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void ipsec_set_tunnel </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>src</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>dst</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Setter function for tunnel source and destination address<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>src</em>&nbsp;</td><td>source address as string (i.g. "192.168.1.3") </td></tr>
    <tr><td valign=top><em>dst</em>&nbsp;</td><td>destination address as string (i.g. "192.168.1.5") </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>void </dd></dl>

<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00481">481</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="ipsecdev.c::ipsecdev_init" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> err_t ipsecdev_init </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct netif *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>netif</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialize the ipsec network device<p>
This function must be called prior to any other operation with this device.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>netif</em>&nbsp;</td><td>lwIP network interface data structure for this device. The structure must be initialized with IP, netmask and gateway address. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>err_t return code</dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000021">Todo:</a></b></dt><dd>this should be somewhere else <p>
selecting the right interface for mapping must be replaced by an more generic method <p>
MAC addresses should be set somewhere else</dd></dl>

<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00402">402</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="ipsecdev.c::ipsecdev_input" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> err_t ipsecdev_input </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct pbuf *&nbsp;</td>
          <td class="mdname" nowrap> <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct netif *&nbsp;</td>
          <td class="mdname" nowrap> <em>inp</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is used to process incomming IP packets.<p>
This function is called by the physical network driver when a new packet has been received. To decide how to handle the packet, the Security Policy Database is called. ESP and AH packets are directly forwarded to <a class="el" href="ipsec_8c.html#a0">ipsec_input()</a> while other packets must pass the SPD lookup.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>p</em>&nbsp;</td><td>pbuf containing the received packet </td></tr>
    <tr><td valign=top><em>inp</em>&nbsp;</td><td>lwIP network interface data structure for this device. The structure must be initialized with IP, netmask and gateway address. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>err_t return code</dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000019">Todo:</a></b></dt><dd>Attention: the pbuf structure should be updated using pbuf_header()</dd></dl>

<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00123">123</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="ipsecdev.c::ipsecdev_netlink_output" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> err_t ipsecdev_netlink_output </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct netif *&nbsp;</td>
          <td class="mdname" nowrap> <em>netif</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct pbuf *&nbsp;</td>
          <td class="mdname" nowrap> <em>p</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is used to send a packet directly out of the network device.<p>
The packet is directly sent as-is the network device output function. It is used to serve ARP traffic.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>netif</em>&nbsp;</td><td>initialized lwIP network interface data structure of this device </td></tr>
    <tr><td valign=top><em>p</em>&nbsp;</td><td>pbuf containing a complete IP packet as payload </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>err_t status </dd></dl>

<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00378">378</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="ipsecdev.c::ipsecdev_output" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> err_t ipsecdev_output </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct netif *&nbsp;</td>
          <td class="mdname" nowrap> <em>netif</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct pbuf *&nbsp;</td>
          <td class="mdname" nowrap> <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct ip_addr *&nbsp;</td>
          <td class="mdname" nowrap> <em>ipaddr</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is used to send a packet out to the network device.<p>
IPsec processing for outbound traffic is done here before forwarding the IP packet to the physical network device. The SPD is queried in order to know how the packet must be handled.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>netif</em>&nbsp;</td><td>initialized lwIP network interface data structure of this device </td></tr>
    <tr><td valign=top><em>p</em>&nbsp;</td><td>pbuf containing a complete IP packet as payload </td></tr>
    <tr><td valign=top><em>ipaddr</em>&nbsp;</td><td>destination IP address </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>err_t status</dd></dl>
backup of physical destination IP address (inner IP header may become encrypted)<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000020">Todo:</a></b></dt><dd>this static access to the HW device must be replaced by a more flexible method <p>
lwIP TCP ESP outbound processing needs to add data after the original packet. Since the lwIP TCP does leave any room after the original packet, we copy the packet into a larger buffer. This step can be avoided if enough room is left after the packet when TCP allocates memory. </dd></dl>

<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00243">243</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="ipsecdev.c::ipsecdev_service" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void ipsecdev_service </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct netif *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>netif</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This is just used to provide an consisstend interface. This function has no functionality.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>netif</em>&nbsp;</td><td>initialized lwIP network interface data structure of this device </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>void </dd></dl>

<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00100">100</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a7" doxytag="ipsecdev.c::databases" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structdb__set__netif__struct.html">db_set_netif</a>* <a class="el" href="ipsecdev_8c.html#a7">databases</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
reference to the SPD and SA configuration 
<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00088">88</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="ipsecdev.c::db_sets" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structdb__set__netif__struct.html">db_set_netif</a> <a class="el" href="ipsecdev_8c.html#a6">db_sets</a>[]
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This structure holds sets of databases used by one network interface. Each successful call of <a class="el" href="sa_8c.html#a2">ipsec_spd_load_dbs()</a> will return a pointer to an entry of this structure array. One entry holds pointers to a inbound and outbound SPD and SAD table. 
<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00087">87</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="ipsecdev.c::inbound_sad_config" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structsa__entry__struct.html">sad_entry</a> <a class="el" href="ipsecdev_8c.html#a2">inbound_sad_config</a>[]
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
inbound SAD configuration data 
<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00082">82</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="ipsecdev.c::inbound_spd_config" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structspd__entry__struct.html">spd_entry</a> <a class="el" href="ipsecdev_8c.html#a3">inbound_spd_config</a>[]
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
inbound SPD configuration data 
<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00083">83</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="ipsecdev.c::mapped_netif" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> struct netif <a class="el" href="ipsecdev_8c.html#a8">mapped_netif</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
handler of physical output device 
<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00089">89</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="ipsecdev.c::outbound_sad_config" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structsa__entry__struct.html">sad_entry</a> <a class="el" href="ipsecdev_8c.html#a4">outbound_sad_config</a>[]
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
outbound SAD configuration data 
<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00084">84</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="ipsecdev.c::outbound_spd_config" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structspd__entry__struct.html">spd_entry</a> <a class="el" href="ipsecdev_8c.html#a5">outbound_spd_config</a>[]
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
outbound SPD configuration data 
<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00085">85</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="ipsecdev.c::tunnel_dst_addr" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="types_8h.html#a4">__u32</a> <a class="el" href="ipsecdev_8c.html#a10">tunnel_dst_addr</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
tunnel destination address (external address the other IPsec tunnel endpoint) 
<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00091">91</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="ipsecdev.c::tunnel_src_addr" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="types_8h.html#a4">__u32</a> <a class="el" href="ipsecdev_8c.html#a9">tunnel_src_addr</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
tunnel source address (external address this IPsec device) 
<p>
Definition at line <a class="el" href="ipsecdev_8c-source.html#l00090">90</a> of file <a class="el" href="ipsecdev_8c-source.html">ipsecdev.c</a>.    </td>
  </tr>
</table>
	</td>
  </tr>
</table>
<hr>
<div align="center">Copyright 2003 by Christian Scheurer and Niklaus Schild</div>
</html>
