<html>
<head>
<title>embedded IPsec - IPsec library</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="doxygen.css" type="text/css">
</head>

<body bgcolor="#FFFFFF" text="#000000">
<table width="98%" border="0" align="center">
  <tr>
    <td>
      <h2 align="left"><img src="logo_small.gif" alt="embedded IPsec"> source 
        code documentation </h2>
<hr>

<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>sa.h</h1><a href="sa_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment"> * embedded IPsec</span>
00003 <span class="comment"> * Copyright (c) 2003 Niklaus Schild and Christian Scheurer, HTI Biel/Bienne</span>
00004 <span class="comment"> * All rights reserved.</span>
00005 <span class="comment"> *</span>
00006 <span class="comment"> * Redistribution and use in source and binary forms, with or without modification,</span>
00007 <span class="comment"> * are permitted provided that the following conditions are met:</span>
00008 <span class="comment"> *</span>
00009 <span class="comment"> * 1. Redistributions of source code must retain the above copyright notice,</span>
00010 <span class="comment"> *    this list of conditions and the following disclaimer.</span>
00011 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright notice,</span>
00012 <span class="comment"> *    this list of conditions and the following disclaimer in the documentation</span>
00013 <span class="comment"> *    and/or other materials provided with the distribution.</span>
00014 <span class="comment"> * 3. The name of the author may not be used to endorse or promote products</span>
00015 <span class="comment"> *    derived from this software without specific prior written permission.</span>
00016 <span class="comment"> *</span>
00017 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED</span>
00018 <span class="comment"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF</span>
00019 <span class="comment"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT</span>
00020 <span class="comment"> * SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,</span>
00021 <span class="comment"> * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT</span>
00022 <span class="comment"> * OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span>
00023 <span class="comment"> * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span>
00024 <span class="comment"> * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING</span>
00025 <span class="comment"> * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY</span>
00026 <span class="comment"> * OF SUCH DAMAGE.</span>
00027 <span class="comment"> *</span>
00028 <span class="comment"> */</span>
00029 
00041 <span class="preprocessor">#ifndef __SA_H__</span>
00042 <span class="preprocessor"></span><span class="preprocessor">#define __SA_H__</span>
00043 <span class="preprocessor"></span>
00044 <span class="preprocessor">#include "<a class="code" href="types_8h.html">ipsec/types.h</a>"</span>
00045 <span class="preprocessor">#include "<a class="code" href="util_8h.html">ipsec/util.h</a>"</span>
00046 <span class="preprocessor">#include "<a class="code" href="ipsec_8h.html">ipsec/ipsec.h</a>"</span>
00047 
00048 
<a name="l00049"></a><a class="code" href="sa_8h.html#a0">00049</a> <span class="preprocessor">#define IPSEC_MAX_SAD_ENTRIES   (10)    </span>
<a name="l00050"></a><a class="code" href="sa_8h.html#a1">00050</a> <span class="preprocessor">#define IPSEC_MAX_SPD_ENTRIES   (10)    </span>
<a name="l00052"></a><a class="code" href="sa_8h.html#a2">00052</a> <span class="preprocessor">#define IPSEC_FREE                              (0)             </span>
<a name="l00053"></a><a class="code" href="sa_8h.html#a3">00053</a> <span class="preprocessor">#define IPSEC_USED                              (1)             </span>
<a name="l00055"></a><a class="code" href="sa_8h.html#a4">00055</a> <span class="preprocessor">#define POLICY_APPLY                    (0)             </span>
<a name="l00056"></a><a class="code" href="sa_8h.html#a5">00056</a> <span class="preprocessor">#define POLICY_BYPASS                   (1)             </span>
<a name="l00057"></a><a class="code" href="sa_8h.html#a6">00057</a> <span class="preprocessor">#define POLICY_DISCARD                  (2)             </span>
<a name="l00059"></a><a class="code" href="sa_8h.html#a7">00059</a> <span class="preprocessor">#define IPSEC_TUNNEL                    (1)             </span>
<a name="l00060"></a><a class="code" href="sa_8h.html#a8">00060</a> <span class="preprocessor">#define IPSEC_TRANSPORT                 (2)             </span>
<a name="l00062"></a><a class="code" href="sa_8h.html#a9">00062</a> <span class="preprocessor">#define IPSEC_DES                               (1)             </span>
<a name="l00063"></a><a class="code" href="sa_8h.html#a10">00063</a> <span class="preprocessor">#define IPSEC_3DES                              (2)             </span>
<a name="l00064"></a><a class="code" href="sa_8h.html#a11">00064</a> <span class="preprocessor">#define IPSEC_IDEA                              (3)             </span>
<a name="l00066"></a><a class="code" href="sa_8h.html#a12">00066</a> <span class="preprocessor">#define IPSEC_HMAC_MD5                  (1)             </span>
<a name="l00067"></a><a class="code" href="sa_8h.html#a13">00067</a> <span class="preprocessor">#define IPSEC_HMAC_SHA1                 (2)             </span>
<a name="l00069"></a><a class="code" href="sa_8h.html#a14">00069</a> <span class="preprocessor">#define IPSEC_NR_NETIFS                 (1)             </span>
<a name="l00071"></a><a class="code" href="sa_8h.html#a19">00071</a> <span class="preprocessor">typedef struct sa_entry_struct sad_entry ;                                      </span>
<a name="l00076"></a><a class="code" href="structsa__entry__struct.html">00076</a> <span class="preprocessor">struct sa_entry_struct</span>
00077 <span class="preprocessor"></span>{
00078         <span class="comment">/* this are the index fields */</span>
<a name="l00079"></a><a class="code" href="structsa__entry__struct.html#o0">00079</a>         <a class="code" href="types_8h.html#a4">__u32</a>           dest;                           
<a name="l00080"></a><a class="code" href="structsa__entry__struct.html#o1">00080</a>         <a class="code" href="types_8h.html#a4">__u32</a>           dest_netaddr ;          
<a name="l00081"></a><a class="code" href="structsa__entry__struct.html#o2">00081</a>         <a class="code" href="types_8h.html#a4">__u32</a>           spi;                            
<a name="l00082"></a><a class="code" href="structsa__entry__struct.html#o3">00082</a>         <a class="code" href="types_8h.html#a0">__u8</a>            protocol ;                      
<a name="l00083"></a><a class="code" href="structsa__entry__struct.html#o4">00083</a>         <a class="code" href="types_8h.html#a0">__u8</a>            <a class="code" href="sa_8h.html#a24">mode</a> ;                          
00084         <span class="comment">/* this fields are used to maintain the current connection */</span>
<a name="l00085"></a><a class="code" href="structsa__entry__struct.html#o5">00085</a>         <a class="code" href="types_8h.html#a4">__u32</a>           sequence_number ;       
<a name="l00086"></a><a class="code" href="structsa__entry__struct.html#o6">00086</a>         <a class="code" href="types_8h.html#a0">__u8</a>            replay_win ;            
<a name="l00087"></a><a class="code" href="structsa__entry__struct.html#o7">00087</a>         <a class="code" href="types_8h.html#a4">__u32</a>           lifetime ;                      
<a name="l00088"></a><a class="code" href="structsa__entry__struct.html#o8">00088</a>         <a class="code" href="types_8h.html#a2">__u16</a>           path_mtu ;                      
00089         <span class="comment">/* this fields are used for the cryptography */</span>
<a name="l00090"></a><a class="code" href="structsa__entry__struct.html#o9">00090</a>         <a class="code" href="types_8h.html#a0">__u8</a>            <a class="code" href="sa_8h.html#a25">enc_alg</a> ;                                               
<a name="l00091"></a><a class="code" href="structsa__entry__struct.html#o10">00091</a>         <a class="code" href="types_8h.html#a0">__u8</a>            enckey[<a class="code" href="ipsec_8h.html#a2">IPSEC_MAX_ENCKEY_LEN</a>];   
<a name="l00092"></a><a class="code" href="structsa__entry__struct.html#o11">00092</a>         <a class="code" href="types_8h.html#a0">__u8</a>            <a class="code" href="sa_8h.html#a26">auth_alg</a> ;                                              
<a name="l00093"></a><a class="code" href="structsa__entry__struct.html#o12">00093</a>         <a class="code" href="types_8h.html#a0">__u8</a>            authkey[<a class="code" href="ipsec_8h.html#a6">IPSEC_MAX_AUTHKEY_LEN</a>] ;
<a name="l00094"></a><a class="code" href="structsa__entry__struct.html#o13">00094</a>         <a class="code" href="structsa__entry__struct.html">sad_entry</a>       *next ;                                                 
<a name="l00095"></a><a class="code" href="structsa__entry__struct.html#o14">00095</a>         <a class="code" href="structsa__entry__struct.html">sad_entry</a>       *prev ;                                                 
<a name="l00096"></a><a class="code" href="structsa__entry__struct.html#o15">00096</a>         <a class="code" href="types_8h.html#a0">__u8</a>            use_flag ;                                              
00099 };
00100 
<a name="l00101"></a><a class="code" href="sa_8h.html#a20">00101</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structspd__entry__struct.html">spd_entry_struct</a> <a class="code" href="sa_8h.html#a20">spd_entry</a> ;             
<a name="l00106"></a><a class="code" href="structspd__entry__struct.html">00106</a> <span class="keyword">struct </span><a class="code" href="structspd__entry__struct.html">spd_entry_struct</a>
00107 {
<a name="l00108"></a><a class="code" href="structspd__entry__struct.html#o0">00108</a>         <a class="code" href="types_8h.html#a4">__u32</a>           <a class="code" href="structspd__entry__struct.html#o0">src</a> ;                   
<a name="l00109"></a><a class="code" href="structspd__entry__struct.html#o1">00109</a>         <a class="code" href="types_8h.html#a4">__u32</a>           <a class="code" href="structspd__entry__struct.html#o1">src_netaddr</a> ;   
<a name="l00110"></a><a class="code" href="structspd__entry__struct.html#o2">00110</a>         <a class="code" href="types_8h.html#a4">__u32</a>           <a class="code" href="structspd__entry__struct.html#o2">dest</a> ;                  
<a name="l00111"></a><a class="code" href="structspd__entry__struct.html#o3">00111</a>         <a class="code" href="types_8h.html#a4">__u32</a>           <a class="code" href="structspd__entry__struct.html#o3">dest_netaddr</a> ;  
<a name="l00112"></a><a class="code" href="structspd__entry__struct.html#o4">00112</a>         <a class="code" href="types_8h.html#a0">__u8</a>            <a class="code" href="structspd__entry__struct.html#o4">protocol</a> ;              
<a name="l00113"></a><a class="code" href="structspd__entry__struct.html#o5">00113</a>         <a class="code" href="types_8h.html#a2">__u16</a>           <a class="code" href="structspd__entry__struct.html#o5">src_port</a> ;              
<a name="l00114"></a><a class="code" href="structspd__entry__struct.html#o6">00114</a>         <a class="code" href="types_8h.html#a2">__u16</a>           <a class="code" href="structspd__entry__struct.html#o6">dest_port</a> ;             
<a name="l00115"></a><a class="code" href="structspd__entry__struct.html#o7">00115</a>         <a class="code" href="types_8h.html#a0">__u8</a>            <a class="code" href="structspd__entry__struct.html#o7">policy</a> ;                
<a name="l00116"></a><a class="code" href="structspd__entry__struct.html#o8">00116</a>         <a class="code" href="structsa__entry__struct.html">sad_entry</a>       *<a class="code" href="structspd__entry__struct.html#o8">sa</a> ;                   
<a name="l00117"></a><a class="code" href="structspd__entry__struct.html#o9">00117</a>         <a class="code" href="sa_8h.html#a20">spd_entry</a>       *<a class="code" href="structspd__entry__struct.html#o9">next</a> ;                 
<a name="l00118"></a><a class="code" href="structspd__entry__struct.html#o10">00118</a>         <a class="code" href="sa_8h.html#a20">spd_entry</a>       *<a class="code" href="structspd__entry__struct.html#o10">prev</a> ;                 
<a name="l00119"></a><a class="code" href="structspd__entry__struct.html#o11">00119</a>         <a class="code" href="types_8h.html#a0">__u8</a>            <a class="code" href="structspd__entry__struct.html#o11">use_flag</a> ;              
00120 };
00121 
<a name="l00125"></a><a class="code" href="structspd__table__struct.html">00125</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structspd__table__struct.html">spd_table_struct</a>
00126 {
<a name="l00127"></a><a class="code" href="structspd__table__struct.html#o0">00127</a>         <a class="code" href="sa_8h.html#a20">spd_entry</a>       *<a class="code" href="structspd__table__struct.html#o0">table</a> ;                
<a name="l00128"></a><a class="code" href="structspd__table__struct.html#o1">00128</a>         <a class="code" href="sa_8h.html#a20">spd_entry</a>       *<a class="code" href="structspd__table__struct.html#o1">first</a> ;                
<a name="l00129"></a><a class="code" href="structspd__table__struct.html#o2">00129</a>         <a class="code" href="sa_8h.html#a20">spd_entry</a>       *<a class="code" href="structspd__table__struct.html#o2">last</a> ;                 
<a name="l00130"></a><a class="code" href="structspd__table__struct.html#o3">00130</a>         <span class="keywordtype">int</span>                     <a class="code" href="structspd__table__struct.html#o3">size</a> ;                  
00131 } <a class="code" href="structspd__table__struct.html">spd_table</a>;
00132 
<a name="l00133"></a><a class="code" href="structsad__table__struct.html">00133</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structsad__table__struct.html">sad_table_struct</a>
00134 {
<a name="l00135"></a><a class="code" href="structsad__table__struct.html#o0">00135</a>         <a class="code" href="structsa__entry__struct.html">sad_entry</a>       *<a class="code" href="structsad__table__struct.html#o0">table</a> ;                
<a name="l00136"></a><a class="code" href="structsad__table__struct.html#o1">00136</a>         <a class="code" href="structsa__entry__struct.html">sad_entry</a>       *<a class="code" href="structsad__table__struct.html#o1">first</a> ;                
<a name="l00137"></a><a class="code" href="structsad__table__struct.html#o2">00137</a>         <a class="code" href="structsa__entry__struct.html">sad_entry</a>       *<a class="code" href="structsad__table__struct.html#o2">last</a> ;                 
00138 } <a class="code" href="structsad__table__struct.html">sad_table</a> ;
00139 
<a name="l00140"></a><a class="code" href="structdb__set__netif__struct.html">00140</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structdb__set__netif__struct.html">db_set_netif_struct</a>
00141 {
<a name="l00142"></a><a class="code" href="structdb__set__netif__struct.html#o0">00142</a>         <a class="code" href="structspd__table__struct.html">spd_table</a>       <a class="code" href="structdb__set__netif__struct.html#o0">inbound_spd</a> ;   
<a name="l00143"></a><a class="code" href="structdb__set__netif__struct.html#o1">00143</a>         <a class="code" href="structspd__table__struct.html">spd_table</a>       <a class="code" href="structdb__set__netif__struct.html#o1">outbound_spd</a> ;  
<a name="l00144"></a><a class="code" href="structdb__set__netif__struct.html#o2">00144</a>         <a class="code" href="structsad__table__struct.html">sad_table</a>       <a class="code" href="structdb__set__netif__struct.html#o2">inbound_sad</a> ;   
<a name="l00145"></a><a class="code" href="structdb__set__netif__struct.html#o3">00145</a>         <a class="code" href="structsad__table__struct.html">sad_table</a>       <a class="code" href="structdb__set__netif__struct.html#o3">outbound_sad</a> ;  
<a name="l00146"></a><a class="code" href="structdb__set__netif__struct.html#o4">00146</a>         <a class="code" href="types_8h.html#a0">__u8</a>            <a class="code" href="structdb__set__netif__struct.html#o4">use_flag</a> ;              
00147 } <a class="code" href="structdb__set__netif__struct.html">db_set_netif</a> ;
00148 
00149 
<a name="l00150"></a><a class="code" href="sa_8h.html#a15">00150</a> <span class="preprocessor">#define SPD_ENTRY(s1, s2, s3, s4, sn1, sn2, sn3, sn4, d1, d2, d3, d4, dn1, dn2, dn3, dn4, proto, src_port, dest_port, policy, sa_ptr) \</span>
00151 <span class="preprocessor">                        IPSEC_IP4_ADDR_NET(s1, s2, s3, s4), \</span>
00152 <span class="preprocessor">                        IPSEC_IP4_ADDR_NET(sn1, sn2, sn3, sn4), \</span>
00153 <span class="preprocessor">                        IPSEC_IP4_ADDR_NET(d1, d2, d3, d4), \</span>
00154 <span class="preprocessor">                        IPSEC_IP4_ADDR_NET(dn1, dn2, dn3, dn4), \</span>
00155 <span class="preprocessor">                        proto, IPSEC_HTONS(src_port), IPSEC_HTONS(dest_port), policy, sa_ptr, 0, 0, \</span>
00156 <span class="preprocessor">                        IPSEC_USED                      </span>
00158 <span class="preprocessor">#define SAD_ENTRY(d1, d2, d3, d4, dn1, dn2, dn3, dn4, spi, proto, mode, enc_alg, ek1, ek2, ek3, ek4, ek5, ek6, ek7, ek8, ek9, ek10, ek11, ek12, ek13, ek14, ek15, ek16, ek17, ek18, ek19, ek20, ek21, ek22, ek23, ek24, auth_alg, ak1, ak2, ak3, ak4, ak5, ak6, ak7, ak8, ak9, ak10, ak11, ak12, ak13, ak14, ak15, ak16, ak17, ak18, ak19, ak20) \</span>
00159 <span class="preprocessor">                        IPSEC_IP4_ADDR_2(d1, d2, d3, d4), \</span>
00160 <span class="preprocessor">                        IPSEC_IP4_ADDR_2(dn1, dn2, dn3, dn4), \</span>
00161 <span class="preprocessor">                        IPSEC_HTONL(spi), \</span>
00162 <span class="preprocessor">                        proto, \ </span>
00163 <span class="preprocessor"></span>                        <a class="code" href="sa_8h.html#a24">mode</a>, \
<a name="l00164"></a><a class="code" href="sa_8h.html#a16">00164</a>                         0, 0, 0, 1450, \
00165                         <a class="code" href="sa_8h.html#a25">enc_alg</a>, \
00166                         {ek1, ek2, ek3, ek4, ek5, ek6, ek7, ek8, ek9, ek10, ek11, ek12, ek13, ek14, ek15, ek16, ek17, ek18, ek19, ek20, ek21, ek22, ek23, ek24}, \
00167                         <a class="code" href="sa_8h.html#a26">auth_alg</a>, \
00168                         {ak1, ak2, ak3, ak4, ak5, ak6, ak7, ak8, ak9, ak10, ak11, ak12, ak13, ak14, ak15, ak16, ak17, ak18, ak19, ak20}, \
<a name="l00169"></a><a class="code" href="sa_8h.html#a24">00169</a>                         0,0, <a class="code" href="sa_8h.html#a3">IPSEC_USED</a>         
00171 <span class="preprocessor">#define EMPTY_SAD_ENTRY { 0, 0, 0, 0, 0, 0, \</span>
00172 <span class="preprocessor">                                                  0, 0, 0, 0, 0, 0, \ </span>
00173 <span class="preprocessor"></span>                                                  0, 0, 0, 0, 0, 0, \
00174                                                   0, 0, 0, 0, 0, 0, \
00175                                                   0, 0, 0, 0, 0, 0, \
00176                                                   0, 0, 0, 0, 0, 0, \
<a name="l00177"></a><a class="code" href="sa_8h.html#a17">00177</a>                                                   0, 0, 0, 0, 0, 0, \
00178                                                   0, 0, 0, 0, 0, 0, \
00179                                                   0, 0, 0, 0, 0, 0, \
00180                                                   <a class="code" href="sa_8h.html#a2">IPSEC_FREE</a> } 
00182 <span class="preprocessor">#define EMPTY_SPD_ENTRY { 0, 0, 0, 0, 0, 0, \</span>
00183 <span class="preprocessor">                                                  0, IPSEC_FREE } </span>
00186 <span class="preprocessor"></span><span class="comment">/* SPD functions */</span>
00187 <a class="code" href="structdb__set__netif__struct.html">db_set_netif</a>    *<a class="code" href="sa_8c.html#a2">ipsec_spd_load_dbs</a>(spd_entry *inbound_spd_data, spd_entry *outbound_spd_data, <a class="code" href="structsa__entry__struct.html">sad_entry</a> *inbound_sad_data, <a class="code" href="structsa__entry__struct.html">sad_entry</a> *outbound_sad_data) ;
<a name="l00188"></a><a class="code" href="sa_8h.html#a18">00188</a> 
00189 <a class="code" href="types_8h.html#a6">ipsec_status</a>    <a class="code" href="sa_8c.html#a3">ipsec_spd_release_dbs</a>(<a class="code" href="structdb__set__netif__struct.html">db_set_netif</a> *dbs) ;
00190 
00191 <a class="code" href="sa_8h.html#a20">spd_entry</a> *<a class="code" href="sa_8c.html#a4">ipsec_spd_get_free</a>(<a class="code" href="structspd__table__struct.html">spd_table</a> *table) ;
00192 
00193 <a class="code" href="sa_8h.html#a20">spd_entry</a> *<a class="code" href="sa_8c.html#a5">ipsec_spd_add</a>(<a class="code" href="types_8h.html#a4">__u32</a> src, <a class="code" href="types_8h.html#a4">__u32</a> src_net, <a class="code" href="types_8h.html#a4">__u32</a> dst, 
00194                          <a class="code" href="types_8h.html#a4">__u32</a> dst_net, <a class="code" href="types_8h.html#a0">__u8</a> proto, <a class="code" href="types_8h.html#a2">__u16</a> src_port, 
00195                                                  <a class="code" href="types_8h.html#a2">__u16</a> dst_port, <a class="code" href="types_8h.html#a0">__u8</a> policy, <a class="code" href="structspd__table__struct.html">spd_table</a> *table) ;
00196 
00197 <a class="code" href="types_8h.html#a6">ipsec_status</a> <a class="code" href="sa_8c.html#a7">ipsec_spd_del</a>(spd_entry *entry, <a class="code" href="structspd__table__struct.html">spd_table</a> *table) ;
00198 
00199 <a class="code" href="types_8h.html#a6">ipsec_status</a> <a class="code" href="sa_8c.html#a6">ipsec_spd_add_sa</a>(spd_entry *entry, <a class="code" href="structsa__entry__struct.html">sad_entry</a> *sa) ;
00200 
00201 <a class="code" href="sa_8h.html#a20">spd_entry</a> *<a class="code" href="sa_8c.html#a8">ipsec_spd_lookup</a>(<a class="code" href="structipsec__ip__hdr__struct.html">ipsec_ip_header</a> *header, <a class="code" href="structspd__table__struct.html">spd_table</a> *table) ;
00202 
00203 <span class="keywordtype">void</span> <a class="code" href="sa_8c.html#a9">ipsec_spd_print_single</a>(spd_entry *entry) ;
00204 
00205 <span class="keywordtype">void</span> <a class="code" href="sa_8c.html#a10">ipsec_spd_print</a>(<a class="code" href="structspd__table__struct.html">spd_table</a> *table) ;
00206 
00207 <span class="comment">/* SAD functions */</span>
00208 <a class="code" href="structsa__entry__struct.html">sad_entry</a> *<a class="code" href="sa_8c.html#a11">ipsec_sad_get_free</a>(<a class="code" href="structsad__table__struct.html">sad_table</a> *table) ;
00209 
00210 <a class="code" href="structsa__entry__struct.html">sad_entry</a> *<a class="code" href="sa_8c.html#a12">ipsec_sad_add</a>(<a class="code" href="structsa__entry__struct.html">sad_entry</a> *entry, <a class="code" href="structsad__table__struct.html">sad_table</a> *table) ;
00211 
00212 <a class="code" href="types_8h.html#a6">ipsec_status</a> <a class="code" href="sa_8c.html#a13">ipsec_sad_del</a>(<a class="code" href="structsa__entry__struct.html">sad_entry</a> *entry, <a class="code" href="structsad__table__struct.html">sad_table</a> *table) ;
00213 
00214 <a class="code" href="structsa__entry__struct.html">sad_entry</a> *<a class="code" href="sa_8c.html#a14">ipsec_sad_lookup</a>(<a class="code" href="types_8h.html#a4">__u32</a> dest, <a class="code" href="types_8h.html#a0">__u8</a> proto, <a class="code" href="types_8h.html#a4">__u32</a> spi, <a class="code" href="structsad__table__struct.html">sad_table</a> *table) ;
00215 
00216 <span class="keywordtype">void</span> <a class="code" href="sa_8c.html#a15">ipsec_sad_print_single</a>(<a class="code" href="structsa__entry__struct.html">sad_entry</a> *entry) ;
00217 
00218 <span class="keywordtype">void</span> <a class="code" href="sa_8c.html#a16">ipsec_sad_print</a>(<a class="code" href="structsad__table__struct.html">sad_table</a> *table) ;
00219 
00220 <a class="code" href="types_8h.html#a4">__u32</a> <a class="code" href="sa_8c.html#a17">ipsec_sad_get_spi</a>(<a class="code" href="structipsec__ip__hdr__struct.html">ipsec_ip_header</a> *header) ;
00221 
00222 <a class="code" href="types_8h.html#a6">ipsec_status</a> <a class="code" href="sa_8c.html#a18">ipsec_spd_flush</a>(<a class="code" href="structspd__table__struct.html">spd_table</a> *table, spd_entry *def_entry) ;
00223 
00224 <a class="code" href="types_8h.html#a6">ipsec_status</a> <a class="code" href="sa_8c.html#a19">ipsec_sad_flush</a>(<a class="code" href="structsad__table__struct.html">sad_table</a> *table) ;
00225 
00226 <span class="preprocessor">#endif</span>
</pre></div>	</td>
  </tr>
</table>
<hr>
<div align="center">Copyright 2003 by Christian Scheurer and Niklaus Schild</div>
</html>
