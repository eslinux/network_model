<html>
<head>
<title>embedded IPsec - IPsec library</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="doxygen.css" type="text/css">
</head>

<body bgcolor="#FFFFFF" text="#000000">
<table width="98%" border="0" align="center">
  <tr>
    <td>
      <h2 align="left"><img src="logo_small.gif" alt="embedded IPsec"> source 
        code documentation </h2>
<hr>

<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>sha1_test.c</h1><a href="sha1__test_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment"> * embedded IPsec</span>
00003 <span class="comment"> * Copyright (c) 2003 Niklaus Schild and Christian Scheurer, HTI Biel/Bienne</span>
00004 <span class="comment"> * All rights reserved.</span>
00005 <span class="comment"> *</span>
00006 <span class="comment"> * Redistribution and use in source and binary forms, with or without modification,</span>
00007 <span class="comment"> * are permitted provided that the following conditions are met:</span>
00008 <span class="comment"> *</span>
00009 <span class="comment"> * 1. Redistributions of source code must retain the above copyright notice,</span>
00010 <span class="comment"> *    this list of conditions and the following disclaimer.</span>
00011 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright notice,</span>
00012 <span class="comment"> *    this list of conditions and the following disclaimer in the documentation</span>
00013 <span class="comment"> *    and/or other materials provided with the distribution.</span>
00014 <span class="comment"> * 3. The name of the author may not be used to endorse or promote products</span>
00015 <span class="comment"> *    derived from this software without specific prior written permission.</span>
00016 <span class="comment"> *</span>
00017 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED</span>
00018 <span class="comment"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF</span>
00019 <span class="comment"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT</span>
00020 <span class="comment"> * SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,</span>
00021 <span class="comment"> * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT</span>
00022 <span class="comment"> * OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span>
00023 <span class="comment"> * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span>
00024 <span class="comment"> * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING</span>
00025 <span class="comment"> * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY</span>
00026 <span class="comment"> * OF SUCH DAMAGE.</span>
00027 <span class="comment"> *</span>
00028 <span class="comment"> */</span>
00029 
00050 <span class="preprocessor">#include &lt;string.h&gt;</span>
00051 
00052 <span class="preprocessor">#include "<a class="code" href="util_8h.html">ipsec/util.h</a>"</span>
00053 <span class="preprocessor">#include "<a class="code" href="sha1_8h.html">ipsec/sha1.h</a>"</span>
00054 <span class="preprocessor">#include "<a class="code" href="debug_8h.html">ipsec/debug.h</a>"</span>
00055 <span class="preprocessor">#include "<a class="code" href="structural__test_8h.html">testing/structural/structural_test.h</a>"</span>
00056 
00057 
<a name="l00062"></a><a class="code" href="sha1__test_8c.html#a0">00062</a> <span class="keywordtype">int</span> <a class="code" href="sha1__test_8c.html#a0">sha1_test_SHA1_Init</a>(<span class="keywordtype">void</span>)
00063 {
00064         <span class="keywordtype">int</span> local_error_count = 0;
00065         <span class="keywordtype">int</span> i;
00066         <a class="code" href="structSHAstate__st.html">SHA_CTX</a>      context;
00067 
00068         context.<a class="code" href="structSHAstate__st.html#o0">h0</a>  = 0x12345678L;
00069         context.<a class="code" href="structSHAstate__st.html#o1">h1</a>  = 0x12345678L;
00070         context.<a class="code" href="structSHAstate__st.html#o2">h2</a>  = 0x12345678L;
00071         context.<a class="code" href="structSHAstate__st.html#o3">h3</a>  = 0x12345678L;
00072         context.<a class="code" href="structSHAstate__st.html#o1">h1</a>  = 0x12345678L;
00073         context.<a class="code" href="structSHAstate__st.html#o5">Nl</a>  = 0x12345678L;
00074         context.<a class="code" href="structSHAstate__st.html#o6">Nh</a>  = 0x12345678L;
00075         memset(&amp;context.<a class="code" href="structSHAstate__st.html#o7">data</a>, <span class="charliteral">'X'</span>, <a class="code" href="sha1_8c.html#a3">SHA_LBLOCK</a>*<span class="keyword">sizeof</span>(<a class="code" href="sha1_8h.html#a0">SHA_LONG</a>));
00076         context.<a class="code" href="structSHAstate__st.html#o8">num</a> = 0x1234;
00077                 
00078         <a class="code" href="sha1_8c.html#a35">SHA1_Init</a>(&amp;context);
00079 
00080         <span class="keywordflow">if</span>(context.<a class="code" href="structSHAstate__st.html#o0">h0</a> != 0x67452301UL) local_error_count++;
00081         <span class="keywordflow">if</span>(context.<a class="code" href="structSHAstate__st.html#o1">h1</a> != 0xefcdab89UL) local_error_count++;
00082         <span class="keywordflow">if</span>(context.<a class="code" href="structSHAstate__st.html#o2">h2</a> != 0x98badcfeUL) local_error_count++;
00083         <span class="keywordflow">if</span>(context.<a class="code" href="structSHAstate__st.html#o3">h3</a> != 0x10325476UL) local_error_count++;
00084         <span class="keywordflow">if</span>(context.<a class="code" href="structSHAstate__st.html#o4">h4</a> != 0xc3d2e1f0UL) local_error_count++;
00085         <span class="keywordflow">if</span>(context.<a class="code" href="structSHAstate__st.html#o5">Nl</a> != 0x00000000UL) local_error_count++;
00086         <span class="keywordflow">if</span>(context.<a class="code" href="structSHAstate__st.html#o6">Nh</a> != 0x00000000UL) local_error_count++;
00087         <span class="keywordflow">if</span>(context.<a class="code" href="structSHAstate__st.html#o8">num</a> != 0x0000)               local_error_count++;
00088         <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="sha1_8c.html#a3">SHA_LBLOCK</a>; i++) {
00089                 <span class="keywordflow">if</span>(context.<a class="code" href="structSHAstate__st.html#o7">data</a>[i] != 0x58585858UL) {
00090                         local_error_count++;
00091                         <span class="keywordflow">break</span>;
00092                 }
00093         }
00094 
00095         <span class="keywordflow">if</span>(local_error_count != 0) {
00096                 printf(<span class="stringliteral">"sha1_test_SHA1_init(): error - SHA1_Init(&amp;context) did made %d errors initializing a SHA_CTX data structure\n"</span>, local_error_count);
00097         }
00098 
00099         <span class="keywordflow">return</span> local_error_count;
00100 }       
00101         
00102 
00103 
<a name="l00108"></a><a class="code" href="sha1__test_8c.html#a1">00108</a> <span class="keywordtype">int</span> <a class="code" href="sha1__test_8c.html#a1">sha1_test_SHA1_Update</a>(<span class="keywordtype">void</span>)
00109 {
00110         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> inputdata_1[65] =
00111         {
00112             0x7C, 0x53, 0x50, 0x53, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 
00113             0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 
00114             0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 
00115             0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 
00116             0x00, 
00117         };
00118         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> inputdata_2[28] =
00119         {
00120             0x77, 0x68, 0x61, 0x74, 0x20, 0x64, 0x6F, 0x20, 0x79, 0x61, 0x20, 0x77, 0x61, 0x6E, 0x74, 0x20, 
00121             0x66, 0x6F, 0x72, 0x20, 0x6E, 0x6F, 0x74, 0x68, 0x69, 0x6E, 0x67, 0x3F, 
00122         };
00123         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> context_before_update_1[94] =
00124         {
00125             0x01, 0x23, 0x45, 0x67, 0x89, 0xAB, 0xCD, 0xEF, 0xFE, 0xDC, 0xBA, 0x98, 0x76, 0x54, 0x32, 0x10, 
00126             0xF0, 0xE1, 0xD2, 0xC3, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F, 0x30, 0x5A, 0x8B, 
00127             0x80, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x97, 0xC1, 0xCD, 0xC6, 0x21, 0x5A, 0xCD, 0x4A, 
00128             0xDC, 0xC1, 0x9D, 0xB7, 0xB4, 0x8E, 0x06, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
00129             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
00130             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
00131         };
00132         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> context_after_update_1[94] =
00133         {
00134             0xA7, 0x8E, 0x4D, 0x62, 0x03, 0x18, 0x2B, 0x3F, 0xE4, 0xB9, 0x54, 0x95, 0xF5, 0x65, 0xC0, 0x28, 
00135             0x8E, 0xB9, 0xFC, 0xA9, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F, 0x30, 0x5A, 0x8B, 
00136             0x80, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x97, 0xC1, 0xCD, 0xC6, 0x21, 0x5A, 0xCD, 0x4A, 
00137             0xDC, 0xC1, 0x9D, 0xB7, 0xB4, 0x8E, 0x06, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
00138             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
00139             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
00140         };
00141         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> context_after_update_2[94] =
00142         {
00143             0xA7, 0x8E, 0x4D, 0x62, 0x03, 0x18, 0x2B, 0x3F, 0xE4, 0xB9, 0x54, 0x95, 0xF5, 0x65, 0xC0, 0x28, 
00144             0x8E, 0xB9, 0xFC, 0xA9, 0xE0, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x74, 0x61, 0x68, 0x77, 
00145             0x20, 0x6F, 0x64, 0x20, 0x77, 0x20, 0x61, 0x79, 0x20, 0x74, 0x6E, 0x61, 0x20, 0x72, 0x6F, 0x66, 
00146             0x68, 0x74, 0x6F, 0x6E, 0x3F, 0x67, 0x6E, 0x69, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
00147             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
00148             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1C, 0x00, 
00149         };
00150         <span class="keywordtype">int</span> local_error_count = 0;
00151         <a class="code" href="structSHAstate__st.html">SHA_CTX</a> context;
00152 
00153         memcpy(&amp;context, context_before_update_1, <span class="keyword">sizeof</span>(context_before_update_1));
00154 
00155         <a class="code" href="sha1_8c.html#a32">SHA1_Update</a>(&amp;context, inputdata_1, <span class="keyword">sizeof</span>(inputdata_1) - 1);
00156 
00157         <span class="keywordflow">if</span>(memcmp(&amp;context, context_after_update_1, <span class="keyword">sizeof</span>(context_after_update_1) - 1) != 0)
00158         {
00159                 local_error_count++;
00160                 <a class="code" href="debug_8h.html#a10">IPSEC_LOG_TST</a>(<span class="stringliteral">"sha1_test_SHA1_Update"</span>, <span class="stringliteral">"FAILURE"</span>, (<span class="stringliteral">"SHA1_Update() failed"</span>)) ;
00161                 printf(<span class="stringliteral">"     INPUT:\n"</span>) ;
00162                 <a class="code" href="debug_8h.html#a13">IPSEC_DUMP_BUFFER</a>(<span class="stringliteral">"          "</span>, inputdata_1, 0, <span class="keyword">sizeof</span>(inputdata_1) - 1);
00163                 printf(<span class="stringliteral">"     OUTPUT:\n"</span>) ;
00164                 <a class="code" href="debug_8h.html#a13">IPSEC_DUMP_BUFFER</a>(<span class="stringliteral">"          "</span>, (<span class="keywordtype">char</span>*)&amp;context, 0, <span class="keyword">sizeof</span>(context));
00165                 printf(<span class="stringliteral">"     EXPECTED OUTPUT:\n"</span>) ;
00166                 <a class="code" href="debug_8h.html#a13">IPSEC_DUMP_BUFFER</a>(<span class="stringliteral">"          "</span>, context_after_update_1, 0, <span class="keyword">sizeof</span>(context_after_update_1));
00167         }
00168 
00169         memcpy(&amp;context, context_after_update_1, <span class="keyword">sizeof</span>(context_after_update_1));
00170 
00171         <a class="code" href="sha1_8c.html#a32">SHA1_Update</a>(&amp;context, inputdata_2, <span class="keyword">sizeof</span>(inputdata_2));
00172 
00173         <span class="keywordflow">if</span>(memcmp(&amp;context, context_after_update_2, <span class="keyword">sizeof</span>(context_after_update_2)) != 0)
00174         {
00175                 local_error_count++;
00176                 <a class="code" href="debug_8h.html#a10">IPSEC_LOG_TST</a>(<span class="stringliteral">"sha1_test_SHA1_Update"</span>, <span class="stringliteral">"FAILURE"</span>, (<span class="stringliteral">"SHA1_Update() failed"</span>)) ;
00177                 printf(<span class="stringliteral">"     INPUT:\n"</span>) ;
00178                 <a class="code" href="debug_8h.html#a13">IPSEC_DUMP_BUFFER</a>(<span class="stringliteral">"          "</span>, inputdata_2, 0, <span class="keyword">sizeof</span>(inputdata_2));
00179                 printf(<span class="stringliteral">"     OUTPUT:\n"</span>) ;
00180                 <a class="code" href="debug_8h.html#a13">IPSEC_DUMP_BUFFER</a>(<span class="stringliteral">"          "</span>, (<span class="keywordtype">char</span>*)&amp;context, 0, <span class="keyword">sizeof</span>(context));
00181                 printf(<span class="stringliteral">"     EXPECTED OUTPUT:\n"</span>) ;
00182                 <a class="code" href="debug_8h.html#a13">IPSEC_DUMP_BUFFER</a>(<span class="stringliteral">"          "</span>, context_after_update_2, 0, <span class="keyword">sizeof</span>(context_after_update_2));
00183         }
00184 
00185         <span class="keywordflow">return</span> local_error_count;
00186 }
00187 
00188 
00189 
00190 
<a name="l00195"></a><a class="code" href="sha1__test_8c.html#a2">00195</a> <span class="keywordtype">int</span> <a class="code" href="sha1__test_8c.html#a2">sha1_test_SHA1_Final</a>(<span class="keywordtype">void</span>)
00196 {
00197         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> context_before_final[94] =
00198         {
00199             0xA7, 0x8E, 0x4D, 0x62, 0x03, 0x18, 0x2B, 0x3F, 0xE4, 0xB9, 0x54, 0x95, 0xF5, 0x65, 0xC0, 0x28, 
00200             0x8E, 0xB9, 0xFC, 0xA9, 0xE0, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x74, 0x61, 0x68, 0x77, 
00201             0x20, 0x6F, 0x64, 0x20, 0x77, 0x20, 0x61, 0x79, 0x20, 0x74, 0x6E, 0x61, 0x20, 0x72, 0x6F, 0x66, 
00202             0x68, 0x74, 0x6F, 0x6E, 0x3F, 0x67, 0x6E, 0x69, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
00203             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
00204             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1C, 0x00, 
00205         };
00206         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> context_after_final[94] =
00207         {
00208             0x44, 0x12, 0x85, 0x98, 0x57, 0x1C, 0xF9, 0x3A, 0xDC, 0xE2, 0x8C, 0xA3, 0x96, 0x87, 0xC3, 0x8E, 
00209             0xC4, 0xDE, 0x08, 0x6C, 0xE0, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x74, 0x61, 0x68, 0x77, 
00210             0x20, 0x6F, 0x64, 0x20, 0x77, 0x20, 0x61, 0x79, 0x20, 0x74, 0x6E, 0x61, 0x20, 0x72, 0x6F, 0x66, 
00211             0x68, 0x74, 0x6F, 0x6E, 0x3F, 0x67, 0x6E, 0x69, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 
00212             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
00213             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xE0, 0x02, 0x00, 0x00, 0x00, 0x00, 
00214         };
00215         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> digest_before_final[20] =
00216         {
00217         
00218             0x00, 0x00, 0xAC, 0x90, 0x44, 0x67, 0xC0, 0x29, 0x27, 0xFB, 0x60, 0x92, 0xC0, 0x97, 0xFE, 0xAC, 
00219             0x1F, 0x30, 0x5A, 0x8B, 
00220         };
00221         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> digest_after_final[20] =
00222         {
00223             0x98, 0x85, 0x12, 0x44, 0x3A, 0xF9, 0x1C, 0x57, 0xA3, 0x8C, 0xE2, 0xDC, 0x8E, 0xC3, 0x87, 0x96, 
00224             0x6C, 0x08, 0xDE, 0xC4, 
00225         };
00226         <span class="keywordtype">int</span>                     local_error_count = 0;
00227         <a class="code" href="structSHAstate__st.html">SHA_CTX</a>                 context;
00228         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   digest[20];
00229 
00230         memcpy(&amp;context, context_before_final, <span class="keyword">sizeof</span>(context_before_final));
00231         memcpy(&amp;digest, digest_before_final, <span class="keyword">sizeof</span>(digest_before_final));
00232 
00233     <a class="code" href="sha1_8c.html#a34">SHA1_Final</a>(digest, &amp;context);
00234 
00235         <span class="keywordflow">if</span>(memcmp(&amp;context, context_after_final, <span class="keyword">sizeof</span>(context_after_final)) != 0)
00236         {
00237                 local_error_count++;
00238                 <a class="code" href="debug_8h.html#a10">IPSEC_LOG_TST</a>(<span class="stringliteral">"sha1_test_SHA1_Final"</span>, <span class="stringliteral">"FAILURE"</span>, (<span class="stringliteral">"context does not match"</span>)) ;
00239                 printf(<span class="stringliteral">"     INPUT:\n"</span>) ;
00240                 <a class="code" href="debug_8h.html#a13">IPSEC_DUMP_BUFFER</a>(<span class="stringliteral">"          "</span>, context_before_final, 0, <span class="keyword">sizeof</span>(context_before_final));
00241                 printf(<span class="stringliteral">"     OUTPUT:\n"</span>) ;
00242                 <a class="code" href="debug_8h.html#a13">IPSEC_DUMP_BUFFER</a>(<span class="stringliteral">"          "</span>, (<span class="keywordtype">char</span>*)&amp;context, 0, <span class="keyword">sizeof</span>(context));
00243                 printf(<span class="stringliteral">"     EXPECTED OUTPUT:\n"</span>) ;
00244                 <a class="code" href="debug_8h.html#a13">IPSEC_DUMP_BUFFER</a>(<span class="stringliteral">"          "</span>, context_after_final, 0, <span class="keyword">sizeof</span>(context_after_final));
00245         }
00246 
00247         <span class="keywordflow">if</span>(memcmp(&amp;digest, digest_after_final, <span class="keyword">sizeof</span>(digest_after_final)) != 0)
00248         {
00249                 local_error_count++;
00250                 <a class="code" href="debug_8h.html#a10">IPSEC_LOG_TST</a>(<span class="stringliteral">"sha1_test_SHA1_Final"</span>, <span class="stringliteral">"FAILURE"</span>, (<span class="stringliteral">"digest does not match"</span>)) ;
00251                 printf(<span class="stringliteral">"     INPUT:\n"</span>) ;
00252                 <a class="code" href="debug_8h.html#a13">IPSEC_DUMP_BUFFER</a>(<span class="stringliteral">"          "</span>, digest_before_final, 0, <span class="keyword">sizeof</span>(digest_before_final));
00253                 printf(<span class="stringliteral">"     OUTPUT:\n"</span>) ;
00254                 <a class="code" href="debug_8h.html#a13">IPSEC_DUMP_BUFFER</a>(<span class="stringliteral">"          "</span>, (<span class="keywordtype">char</span>*)&amp;digest, 0, <span class="keyword">sizeof</span>(digest));
00255                 printf(<span class="stringliteral">"     EXPECTED OUTPUT:\n"</span>) ;
00256                 <a class="code" href="debug_8h.html#a13">IPSEC_DUMP_BUFFER</a>(<span class="stringliteral">"          "</span>, digest_after_final, 0, <span class="keyword">sizeof</span>(digest_after_final));
00257         }
00258 
00259         <span class="keywordflow">return</span> local_error_count;
00260 }
00261 
00262 
00263 
<a name="l00268"></a><a class="code" href="sha1__test_8c.html#a3">00268</a> <span class="keywordtype">void</span> <a class="code" href="sha1__test_8c.html#a3">sha1_test</a>(<a class="code" href="structtest__result__struct.html">test_result</a> *global_results)
00269 {
00270         <a class="code" href="structtest__result__struct.html">test_result</a>     sub_results     = {
00271                                                  13,                    
00272                                                   3,                    
00273                                                   0,                    
00274                                                   0,                    
00275                                         };
00276         <span class="keywordtype">int</span> retcode;
00277 
00278         retcode = <a class="code" href="sha1__test_8c.html#a0">sha1_test_SHA1_Init</a>();
00279         <a class="code" href="structural__test_8h.html#a0">IPSEC_TESTING_EVALUATE</a>(retcode, sub_results, <span class="stringliteral">"sha1_test_SHA1_Init()"</span>, (<span class="stringliteral">"ported from openssl.org"</span>));
00280 
00281         retcode = <a class="code" href="sha1__test_8c.html#a1">sha1_test_SHA1_Update</a>();
00282         <a class="code" href="structural__test_8h.html#a0">IPSEC_TESTING_EVALUATE</a>(retcode, sub_results, <span class="stringliteral">"sha1_test_SHA1_Update()"</span>, (<span class="stringliteral">"ported from openssl.org"</span>));
00283 
00284         retcode = <a class="code" href="sha1__test_8c.html#a2">sha1_test_SHA1_Final</a>();
00285         <a class="code" href="structural__test_8h.html#a0">IPSEC_TESTING_EVALUATE</a>(retcode, sub_results, <span class="stringliteral">"sha1_test_SHA1_Final()"</span>, (<span class="stringliteral">"ported from openssl.org"</span>));
00286 
00287         global_results-&gt;<a class="code" href="structtest__result__struct.html#o0">tests</a> += sub_results.<a class="code" href="structtest__result__struct.html#o0">tests</a>;
00288         global_results-&gt;<a class="code" href="structtest__result__struct.html#o1">functions</a> += sub_results.<a class="code" href="structtest__result__struct.html#o1">functions</a>;
00289         global_results-&gt;<a class="code" href="structtest__result__struct.html#o2">errors</a> += sub_results.<a class="code" href="structtest__result__struct.html#o2">errors</a>;
00290         global_results-&gt;<a class="code" href="structtest__result__struct.html#o3">notimplemented</a> += sub_results.<a class="code" href="structtest__result__struct.html#o3">notimplemented</a>;
00291 }
00292 
00293 
</pre></div>	</td>
  </tr>
</table>
<hr>
<div align="center">Copyright 2003 by Christian Scheurer and Niklaus Schild</div>
</html>
