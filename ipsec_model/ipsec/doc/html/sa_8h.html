<html>
<head>
<title>embedded IPsec - IPsec library</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="doxygen.css" type="text/css">
</head>

<body bgcolor="#FFFFFF" text="#000000">
<table width="98%" border="0" align="center">
  <tr>
    <td>
      <h2 align="left"><img src="logo_small.gif" alt="embedded IPsec"> source 
        code documentation </h2>
<hr>

<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>sa.h File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Header of Security Association management code. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Niklaus Schild &lt;<a href="mailto:n.schild@gmx.ch">n.schild@gmx.ch</a>&gt;</dd></dl>
This document is part of <em>embedded IPsec<br>
 Copyright (c) 2003 Niklaus Schild and Christian Scheurer, HTI Biel/Bienne<br>
 All rights reserved.<br>
 </em><hr>

<p>
Definition in file <a class="el" href="sa_8h-source.html">sa.h</a>.
<p>
<code>#include "<a class="el" href="types_8h-source.html">ipsec/types.h</a>"</code><br>
<code>#include "<a class="el" href="util_8h-source.html">ipsec/util.h</a>"</code><br>
<code>#include "<a class="el" href="ipsec_8h-source.html">ipsec/ipsec.h</a>"</code><br>

<p>
<a href="sa_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="structdb__set__netif__struct.html">db_set_netif_struct</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="structsa__entry__struct.html">sa_entry_struct</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="structsad__table__struct.html">sad_table_struct</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="structspd__entry__struct.html">spd_entry_struct</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="structspd__table__struct.html">spd_table_struct</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a0">IPSEC_MAX_SAD_ENTRIES</a>&nbsp;&nbsp;&nbsp;(10)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a1">IPSEC_MAX_SPD_ENTRIES</a>&nbsp;&nbsp;&nbsp;(10)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a2">IPSEC_FREE</a>&nbsp;&nbsp;&nbsp;(0)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a3">IPSEC_USED</a>&nbsp;&nbsp;&nbsp;(1)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a4">POLICY_APPLY</a>&nbsp;&nbsp;&nbsp;(0)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a5">POLICY_BYPASS</a>&nbsp;&nbsp;&nbsp;(1)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a6">POLICY_DISCARD</a>&nbsp;&nbsp;&nbsp;(2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a7">IPSEC_TUNNEL</a>&nbsp;&nbsp;&nbsp;(1)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a8">IPSEC_TRANSPORT</a>&nbsp;&nbsp;&nbsp;(2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a9">IPSEC_DES</a>&nbsp;&nbsp;&nbsp;(1)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a10">IPSEC_3DES</a>&nbsp;&nbsp;&nbsp;(2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a11">IPSEC_IDEA</a>&nbsp;&nbsp;&nbsp;(3)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a12">IPSEC_HMAC_MD5</a>&nbsp;&nbsp;&nbsp;(1)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a13">IPSEC_HMAC_SHA1</a>&nbsp;&nbsp;&nbsp;(2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a14">IPSEC_NR_NETIFS</a>&nbsp;&nbsp;&nbsp;(1)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a15">SPD_ENTRY</a>(s1, s2, s3, s4, sn1, sn2, sn3, sn4, d1, d2, d3, d4, dn1, dn2, dn3, dn4, proto, src_port, dest_port, policy, sa_ptr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a16">SAD_ENTRY</a>(d1, d2, d3, d4, dn1, dn2, dn3, dn4, spi, proto, <a class="el" href="sa_8h.html#a24">mode</a>, <a class="el" href="sa_8h.html#a25">enc_alg</a>, ek1, ek2, ek3, ek4, ek5, ek6, ek7, ek8, ek9, ek10, ek11, ek12, ek13, ek14, ek15, ek16, ek17, ek18, ek19, ek20, ek21, ek22, ek23, ek24, <a class="el" href="sa_8h.html#a26">auth_alg</a>, ak1, ak2, ak3, ak4, ak5, ak6, ak7, ak8, ak9, ak10, ak11, ak12, ak13, ak14, ak15, ak16, ak17, ak18, ak19, ak20)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a17">EMPTY_SAD_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a18">EMPTY_SPD_ENTRY</a></td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="structsa__entry__struct.html">sa_entry_struct</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a19">sad_entry</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="structspd__entry__struct.html">spd_entry_struct</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a20">spd_entry</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="structspd__table__struct.html">spd_table_struct</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a21">spd_table</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="structsad__table__struct.html">sad_table_struct</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a22">sad_table</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="structdb__set__netif__struct.html">db_set_netif_struct</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a23">db_set_netif</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structdb__set__netif__struct.html">db_set_netif</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a27">ipsec_spd_load_dbs</a> (<a class="el" href="structspd__entry__struct.html">spd_entry</a> *inbound_spd_data, <a class="el" href="structspd__entry__struct.html">spd_entry</a> *outbound_spd_data, <a class="el" href="structsa__entry__struct.html">sad_entry</a> *inbound_sad_data, <a class="el" href="structsa__entry__struct.html">sad_entry</a> *outbound_sad_data)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="types_8h.html#a6">ipsec_status</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a28">ipsec_spd_release_dbs</a> (<a class="el" href="structdb__set__netif__struct.html">db_set_netif</a> *dbs)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structspd__entry__struct.html">spd_entry</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a29">ipsec_spd_get_free</a> (<a class="el" href="structspd__table__struct.html">spd_table</a> *table)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structspd__entry__struct.html">spd_entry</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a30">ipsec_spd_add</a> (<a class="el" href="types_8h.html#a4">__u32</a> src, <a class="el" href="types_8h.html#a4">__u32</a> src_net, <a class="el" href="types_8h.html#a4">__u32</a> dst, <a class="el" href="types_8h.html#a4">__u32</a> dst_net, <a class="el" href="types_8h.html#a0">__u8</a> proto, <a class="el" href="types_8h.html#a2">__u16</a> src_port, <a class="el" href="types_8h.html#a2">__u16</a> dst_port, <a class="el" href="types_8h.html#a0">__u8</a> policy, <a class="el" href="structspd__table__struct.html">spd_table</a> *table)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="types_8h.html#a6">ipsec_status</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a31">ipsec_spd_del</a> (<a class="el" href="structspd__entry__struct.html">spd_entry</a> *entry, <a class="el" href="structspd__table__struct.html">spd_table</a> *table)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="types_8h.html#a6">ipsec_status</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a32">ipsec_spd_add_sa</a> (<a class="el" href="structspd__entry__struct.html">spd_entry</a> *entry, <a class="el" href="structsa__entry__struct.html">sad_entry</a> *sa)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structspd__entry__struct.html">spd_entry</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a33">ipsec_spd_lookup</a> (<a class="el" href="structipsec__ip__hdr__struct.html">ipsec_ip_header</a> *header, <a class="el" href="structspd__table__struct.html">spd_table</a> *table)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a34">ipsec_spd_print_single</a> (<a class="el" href="structspd__entry__struct.html">spd_entry</a> *entry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a35">ipsec_spd_print</a> (<a class="el" href="structspd__table__struct.html">spd_table</a> *table)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structsa__entry__struct.html">sad_entry</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a36">ipsec_sad_get_free</a> (<a class="el" href="structsad__table__struct.html">sad_table</a> *table)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structsa__entry__struct.html">sad_entry</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a37">ipsec_sad_add</a> (<a class="el" href="structsa__entry__struct.html">sad_entry</a> *entry, <a class="el" href="structsad__table__struct.html">sad_table</a> *table)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="types_8h.html#a6">ipsec_status</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a38">ipsec_sad_del</a> (<a class="el" href="structsa__entry__struct.html">sad_entry</a> *entry, <a class="el" href="structsad__table__struct.html">sad_table</a> *table)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structsa__entry__struct.html">sad_entry</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a39">ipsec_sad_lookup</a> (<a class="el" href="types_8h.html#a4">__u32</a> dest, <a class="el" href="types_8h.html#a0">__u8</a> proto, <a class="el" href="types_8h.html#a4">__u32</a> spi, <a class="el" href="structsad__table__struct.html">sad_table</a> *table)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a40">ipsec_sad_print_single</a> (<a class="el" href="structsa__entry__struct.html">sad_entry</a> *entry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a41">ipsec_sad_print</a> (<a class="el" href="structsad__table__struct.html">sad_table</a> *table)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="types_8h.html#a4">__u32</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a42">ipsec_sad_get_spi</a> (<a class="el" href="structipsec__ip__hdr__struct.html">ipsec_ip_header</a> *header)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="types_8h.html#a6">ipsec_status</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a43">ipsec_spd_flush</a> (<a class="el" href="structspd__table__struct.html">spd_table</a> *table, <a class="el" href="structspd__entry__struct.html">spd_entry</a> *def_entry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="types_8h.html#a6">ipsec_status</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a44">ipsec_sad_flush</a> (<a class="el" href="structsad__table__struct.html">sad_table</a> *table)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a24">mode</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a25">enc_alg</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="sa_8h.html#a26">auth_alg</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a17" doxytag="sa.h::EMPTY_SAD_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EMPTY_SAD_ENTRY
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre>{ 0, 0, 0, 0, 0, 0, \
                                                  0, 0, 0, 0, 0, 0, \
</pre></div>&lt; helps to statically configure the SAD entries 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00177">177</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="sa.h::EMPTY_SPD_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EMPTY_SPD_ENTRY
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre>{ 0, 0, 0, 0, 0, 0, \
                                                  0, <a class="code" href="sa_8h.html#a2">IPSEC_FREE</a> }
</pre></div>empty, unconfigured SPD entry 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00188">188</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="sa.h::IPSEC_3DES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IPSEC_3DES&nbsp;&nbsp;&nbsp;(2)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Defines 3DES as the encryption algorithm for an ESP packet 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00063">63</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="sa.h::IPSEC_DES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IPSEC_DES&nbsp;&nbsp;&nbsp;(1)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Defines DES as the encryption algorithm for an ESP packet 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00062">62</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="sa.h::IPSEC_FREE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IPSEC_FREE&nbsp;&nbsp;&nbsp;(0)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Tells you that an SPD entry is free 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00052">52</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="sa.h::IPSEC_HMAC_MD5" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IPSEC_HMAC_MD5&nbsp;&nbsp;&nbsp;(1)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Defines HMAC-MD5 as the authentication algorithm for an AH or an ESP packet 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00066">66</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="sa.h::IPSEC_HMAC_SHA1" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IPSEC_HMAC_SHA1&nbsp;&nbsp;&nbsp;(2)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Defines HMAC-SHA1 as the authentication algorithm for an AH or an ESP packet 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00067">67</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="sa.h::IPSEC_IDEA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IPSEC_IDEA&nbsp;&nbsp;&nbsp;(3)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Defines IDEA as the encryption algorithm for an ESP packet 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00064">64</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="sa.h::IPSEC_MAX_SAD_ENTRIES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IPSEC_MAX_SAD_ENTRIES&nbsp;&nbsp;&nbsp;(10)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Defines the size of SPD entries in the SPD table. 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00049">49</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="sa.h::IPSEC_MAX_SPD_ENTRIES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IPSEC_MAX_SPD_ENTRIES&nbsp;&nbsp;&nbsp;(10)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Defines the size of SAD entries in the SAD table. 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00050">50</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="sa.h::IPSEC_NR_NETIFS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IPSEC_NR_NETIFS&nbsp;&nbsp;&nbsp;(1)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Defines the number of network interfaces. This is used to reserve space for db_netif_struct's 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00069">69</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="sa.h::IPSEC_TRANSPORT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IPSEC_TRANSPORT&nbsp;&nbsp;&nbsp;(2)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Defines TRANSPORT mode as the mode the packet must be processed 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00060">60</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="sa.h::IPSEC_TUNNEL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IPSEC_TUNNEL&nbsp;&nbsp;&nbsp;(1)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Defines TUNNEL mode as the mode the packet must be processed 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00059">59</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="sa.h::IPSEC_USED" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IPSEC_USED&nbsp;&nbsp;&nbsp;(1)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Tells you that an SPD entry is used 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00053">53</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="sa.h::POLICY_APPLY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define POLICY_APPLY&nbsp;&nbsp;&nbsp;(0)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Defines that the policy for this SPD entry means: apply IPsec 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00055">55</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="sa.h::POLICY_BYPASS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define POLICY_BYPASS&nbsp;&nbsp;&nbsp;(1)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Defines that the policy for this SPD entry means: bypass IPsec 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00056">56</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="sa.h::POLICY_DISCARD" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define POLICY_DISCARD&nbsp;&nbsp;&nbsp;(2)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Defines that the policy for this SPD entry means: the packet must be discarded 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00057">57</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="sa.h::SAD_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SAD_ENTRY</td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">d1,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>d2,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>d3,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>d4,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>dn1,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>dn2,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>dn3,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>dn4,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>spi,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>proto,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="sa_8h.html#a24">mode</a>,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="sa_8h.html#a25">enc_alg</a>,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek1,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek2,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek3,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek4,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek5,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek6,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek7,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek8,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek9,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek10,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek11,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek12,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek13,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek14,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek15,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek16,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek17,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek18,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek19,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek20,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek21,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek22,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek23,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ek24,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="sa_8h.html#a26">auth_alg</a>,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak1,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak2,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak3,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak4,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak5,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak6,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak7,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak8,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak9,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak10,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak11,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak12,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak13,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak14,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak15,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak16,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak17,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak18,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak19,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ak20&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre><a class="code" href="util_8h.html#a3">IPSEC_IP4_ADDR_2</a>(d1, d2, d3, d4), \
                        <a class="code" href="util_8h.html#a3">IPSEC_IP4_ADDR_2</a>(dn1, dn2, dn3, dn4), \
                        <a class="code" href="util_8h.html#a5">IPSEC_HTONL</a>(spi), \
                        proto, \
</pre></div>
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00164">164</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="sa.h::SPD_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SPD_ENTRY</td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">s1,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>s2,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>s3,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>s4,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>sn1,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>sn2,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>sn3,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>sn4,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>d1,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>d2,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>d3,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>d4,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>dn1,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>dn2,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>dn3,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>dn4,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>proto,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>src_port,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>dest_port,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>policy,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>sa_ptr&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre><a class="code" href="util_8h.html#a4">IPSEC_IP4_ADDR_NET</a>(s1, s2, s3, s4), \
                        <a class="code" href="util_8h.html#a4">IPSEC_IP4_ADDR_NET</a>(sn1, sn2, sn3, sn4), \
                        <a class="code" href="util_8h.html#a4">IPSEC_IP4_ADDR_NET</a>(d1, d2, d3, d4), \
                        <a class="code" href="util_8h.html#a4">IPSEC_IP4_ADDR_NET</a>(dn1, dn2, dn3, dn4), \
                        proto, <a class="code" href="util_8h.html#a6">IPSEC_HTONS</a>(src_port), <a class="code" href="util_8h.html#a6">IPSEC_HTONS</a>(dest_port), policy, sa_ptr, 0, 0, \
                        <a class="code" href="sa_8h.html#a3">IPSEC_USED</a>
</pre></div>helps to statically configure the SPD entries 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00150">150</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a23" doxytag="sa.h::db_set_netif" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="structdb__set__netif__struct.html">db_set_netif_struct</a>  <a class="el" href="structdb__set__netif__struct.html">db_set_netif</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="sa.h::sad_entry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="structsa__entry__struct.html">sa_entry_struct</a> <a class="el" href="structsa__entry__struct.html">sad_entry</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Security Association Database entry 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00071">71</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="sa.h::sad_table" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="structsad__table__struct.html">sad_table_struct</a>  <a class="el" href="structsad__table__struct.html">sad_table</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="sa.h::spd_entry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="structspd__entry__struct.html">spd_entry_struct</a> <a class="el" href="structspd__entry__struct.html">spd_entry</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This type hold all values used for one SPD entry 
<p>
Definition at line <a class="el" href="sa_8h-source.html#l00101">101</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="sa.h::spd_table" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="structspd__table__struct.html">spd_table_struct</a>  <a class="el" href="structspd__table__struct.html">spd_table</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a37" doxytag="sa.h::ipsec_sad_add" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structsa__entry__struct.html">sad_entry</a>* ipsec_sad_add </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsa__entry__struct.html">sad_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>entry</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structsad__table__struct.html">sad_table</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>table</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Adds an Security Association to an SA table.<p>
The SA entries are added to a statically allocated array of SAD structs. The size is defined by IPSEC_MAX_SAD_ENTRIES, so there cannot be added more entries added as this constant. The order of the entries within the table is not the same as the order within the array. The "table functionality" is implemented in a linked-list, so one must follow the links of the structure to get to the next entry.<p>
Implementation<ol>
<li>This function first gets an empty entry out of the table passed by <a class="el" href="sa_8c.html#a2">ipsec_spd_load_dbs()</a>.</li><li>If a free place was found, then the function arguments are copied to the appropriate place.</li><li>Then the linked-list is re-linked.</li></ol>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>entry</em>&nbsp;</td><td>pointer to the SA structure which will be copied into the table </td></tr>
    <tr><td valign=top><em>table</em>&nbsp;</td><td>pointer to the table where the SA is added </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>A pointer to the added entry when adding was successful <p>
NULL when the entry could not have been added (no free entry or duplicate) </dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000013">Todo:</a></b></dt><dd>right now there is no special order implemented, maybe this is needed </dd></dl>
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000014">Todo:</a></b></dt><dd>this part needs to be rewritten when an order is introduced</dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l00796">796</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="sa.h::ipsec_sad_del" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="types_8h.html#a6">ipsec_status</a> ipsec_sad_del </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsa__entry__struct.html">sad_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>entry</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structsad__table__struct.html">sad_table</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>table</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Deletes an Security Association from an SA table.<p>
This function is simple. If the pointer is within the range of the table, then the entry is cleared. If the pointer does not match, nothing happens.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>entry</em>&nbsp;</td><td>Pointer to the SA entry which needs to be deleted </td></tr>
    <tr><td valign=top><em>table</em>&nbsp;</td><td>Pointer to the SA table</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>IPSEC_STATUS_SUCCESS entry was deleted properly <p>
IPSEC_STATUS_FAILURE entry could not be deleted because not found, or invalid pointer </dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000015">Todo:</a></b></dt><dd>right now there is no special order implemented, maybe this is needed </dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l00870">870</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="sa.h::ipsec_sad_flush" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="types_8h.html#a6">ipsec_status</a> ipsec_sad_flush </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsad__table__struct.html">sad_table</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>table</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Flushes an SAD table.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>table</em>&nbsp;</td><td>pointer to the SAD table </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>IPSEC_STATUS_SUCCESS if the flush was successful </dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l01104">1104</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="sa.h::ipsec_sad_get_free" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structsa__entry__struct.html">sad_entry</a>* ipsec_sad_get_free </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsad__table__struct.html">sad_table</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>table</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Gives back a pointer to the next free entry from the given SA table.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000012">Todo:</a></b></dt><dd>this function should probably be static </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>table</em>&nbsp;</td><td>pointer to the SA table </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>pointer to the free entry if one was found <p>
NULL if no free entry was found </dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l00756">756</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="sa.h::ipsec_sad_get_spi" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="types_8h.html#a4">__u32</a> ipsec_sad_get_spi </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structipsec__ip__hdr__struct.html">ipsec_ip_header</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>header</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the SPI from an IPsec header out of an IP packet.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>header</em>&nbsp;</td><td>pointer to the IP header having an IPsec header as payload </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the SPI if one could be extracted <p>
0 if no SPI could be extracted (not IPsec packet) </dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l01040">1040</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="sa.h::ipsec_sad_lookup" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structsa__entry__struct.html">sad_entry</a>* ipsec_sad_lookup </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="types_8h.html#a4">__u32</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dest</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="types_8h.html#a0">__u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>proto</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="types_8h.html#a4">__u32</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>spi</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structsad__table__struct.html">sad_table</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>table</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Gives back a pointer to a SA matching the SA selectors.<p>
For incoming packets the IPsec packet must be checked against the inbound SAD and for outgoing packets the packet must be checked against the outbound SAD.<p>
Implementation It simply loops over all entries and returns the first match.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dest</em>&nbsp;</td><td>destination IP address </td></tr>
    <tr><td valign=top><em>proto</em>&nbsp;</td><td>IPsec protocol </td></tr>
    <tr><td valign=top><em>spi</em>&nbsp;</td><td>Security Parameters Index </td></tr>
    <tr><td valign=top><em>table</em>&nbsp;</td><td>pointer to the SAD table </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>pointer to the SA entry if one matched <p>
NULL if no matching entry was found </dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l00940">940</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="sa.h::ipsec_sad_print" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void ipsec_sad_print </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsad__table__struct.html">sad_table</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>table</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Prints a SAD table.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>table</em>&nbsp;</td><td>pointer to the SAD table which will be printed </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>void </dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l01014">1014</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="sa.h::ipsec_sad_print_single" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void ipsec_sad_print_single </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsa__entry__struct.html">sad_entry</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>entry</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Prints a single SA entry.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>entry</em>&nbsp;</td><td>pointer to the SA entry which will be printed </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>void </dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l00975">975</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="sa.h::ipsec_spd_add" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structspd__entry__struct.html">spd_entry</a>* ipsec_spd_add </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="types_8h.html#a4">__u32</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>src</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="types_8h.html#a4">__u32</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>src_net</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="types_8h.html#a4">__u32</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dst</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="types_8h.html#a4">__u32</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dst_net</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="types_8h.html#a0">__u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>proto</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="types_8h.html#a2">__u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>src_port</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="types_8h.html#a2">__u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dst_port</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="types_8h.html#a0">__u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>policy</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structspd__table__struct.html">spd_table</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>table</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Adds a Security Policy to an SPD table.<p>
The SPD entries are added to a statically allocated array of SPD structs. The size is defined by IPSEC_MAX_SPD_ENRIES, so there cannot be added more entries added as this constant. The order of the entries within the table is not the same as the order within the array. The "table functionality" is implemented in a linked-list, so one must follow the links of the structure to get to the next entry.<p>
Implementation<ol>
<li>This function first gets an empty entry out of the table passed by <a class="el" href="sa_8c.html#a2">ipsec_spd_load_dbs()</a>.</li><li>If a free place was found, then the function arguments are copied to the appropriate place.</li><li>Then the linked-list is re-linked.</li></ol>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>src</em>&nbsp;</td><td>IP source address </td></tr>
    <tr><td valign=top><em>src_net</em>&nbsp;</td><td>Netmask for the source address </td></tr>
    <tr><td valign=top><em>dst</em>&nbsp;</td><td>IP destination address </td></tr>
    <tr><td valign=top><em>dst_net</em>&nbsp;</td><td>Netmask for the destination address </td></tr>
    <tr><td valign=top><em>proto</em>&nbsp;</td><td>Transport protocol </td></tr>
    <tr><td valign=top><em>src_port</em>&nbsp;</td><td>Source Port </td></tr>
    <tr><td valign=top><em>dst_port</em>&nbsp;</td><td>Destination Port </td></tr>
    <tr><td valign=top><em>policy</em>&nbsp;</td><td>The policy defining how the packet matching the entry must be processed </td></tr>
    <tr><td valign=top><em>table</em>&nbsp;</td><td>Pointer to the SPD table </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>A pointer to the added entry when adding was successful <p>
NULL when the entry could not have been added (no free entry or duplicate) </dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd>right now there is no special order implemented, maybe this is needed </dd></dl>
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000008">Todo:</a></b></dt><dd>this part needs to be rewritten when an order is introduced</dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l00428">428</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="sa.h::ipsec_spd_add_sa" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="types_8h.html#a6">ipsec_status</a> ipsec_spd_add_sa </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structspd__entry__struct.html">spd_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>entry</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structsa__entry__struct.html">sad_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>sa</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Adds a Security Association to a Security Police.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>entry</em>&nbsp;</td><td>pointer to the SPD entry where the SA should be added </td></tr>
    <tr><td valign=top><em>sa</em>&nbsp;</td><td>a pointer to the SA which is added to the SPD </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>IPSEC_STATUS_SUCCESS the entry was added successfully </dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l00496">496</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="sa.h::ipsec_spd_del" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="types_8h.html#a6">ipsec_status</a> ipsec_spd_del </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structspd__entry__struct.html">spd_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>entry</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structspd__table__struct.html">spd_table</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>table</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Deletes an Security Policy from an SPD table.<p>
This function is simple. If the pointer is within the range of the table, then the entry is cleared. If the pointer does not match, nothing happens.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>entry</em>&nbsp;</td><td>Pointer to the SPD entry which needs to be deleted </td></tr>
    <tr><td valign=top><em>table</em>&nbsp;</td><td>Pointer to the SPD table</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>IPSEC_STATUS_SUCCESS entry was deleted properly <p>
IPSEC_STATUS_FAILURE entry could not be deleted because not found, or invalid pointer </dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000009">Todo:</a></b></dt><dd>right now there is no special order implemented, maybe this is needed </dd></dl>
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000010">Todo:</a></b></dt><dd>probably the SA should also be deleted</dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l00523">523</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="sa.h::ipsec_spd_flush" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="types_8h.html#a6">ipsec_status</a> ipsec_spd_flush </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structspd__table__struct.html">spd_table</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>table</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structspd__entry__struct.html">spd_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>def_entry</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Flushes an SPD table and sets a new default entry. The default entry allows to keep a door open for IKE.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>table</em>&nbsp;</td><td>pointer to the SPD table </td></tr>
    <tr><td valign=top><em>def_entry</em>&nbsp;</td><td>pointer to the default entry </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>IPSEC_STATUS_SUCCESS if the flush was successful <p>
IPSEC_STATUS_FAILURE if the flush failed </dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l01078">1078</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="sa.h::ipsec_spd_get_free" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structspd__entry__struct.html">spd_entry</a>* ipsec_spd_get_free </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structspd__table__struct.html">spd_table</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>table</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Gives back a pointer to the next free entry from the given SPD table.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>this function should probably be static </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>table</em>&nbsp;</td><td>pointer to the SPD table </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>pointer to the free entry if one was found <p>
NULL if no free entry was found </dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l00375">375</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="sa.h::ipsec_spd_load_dbs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structdb__set__netif__struct.html">db_set_netif</a>* ipsec_spd_load_dbs </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structspd__entry__struct.html">spd_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>inbound_spd_data</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structspd__entry__struct.html">spd_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>outbound_spd_data</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structsa__entry__struct.html">sad_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>inbound_sad_data</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structsa__entry__struct.html">sad_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>outbound_sad_data</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function initializes the database set, allocated in a per-network manner.<p>
The data which is passed by the pointers should not be used by other functions except the ones of the SA-module. The data passed can be viewed as a place where the SA-module can store its data (Security Policies or Security Associations). The tables which are passed to the function can already be filled up with static configuration data. You can use the SPD_ENTRY and the SAD_ENTRY macro to do this in a nice way.<p>
Implementation<ol>
<li>First the function gets a free entry (set of structs) out of the db_sets table.</li><li>Then it sets the pointer of this struct members.</li><li>On all entries in the table which are not already filled are set to IPSEC_FREE.</li><li>In the last and most ugly part of this function tables are linked together so that the linked list is setup properly.</li></ol>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>inbound_spd_data</em>&nbsp;</td><td>pointer to a table where inbound Security Policies will be stored </td></tr>
    <tr><td valign=top><em>outbound_spd_data</em>&nbsp;</td><td>pointer to a table where outbound Security Policies will be stored </td></tr>
    <tr><td valign=top><em>inbound_sad_data</em>&nbsp;</td><td>pointer to a table where inbound Security Associations will be stored </td></tr>
    <tr><td valign=top><em>outbound_sad_data</em>&nbsp;</td><td>pointer to a table where outbound Security Associations will be stored</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>pointer to the initialized set of DB's if the setup was successful <p>
NULL if loading failed </dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l00136">136</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="sa.h::ipsec_spd_lookup" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structspd__entry__struct.html">spd_entry</a>* ipsec_spd_lookup </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structipsec__ip__hdr__struct.html">ipsec_ip_header</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>header</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structspd__table__struct.html">spd_table</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>table</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns an pointer to an SPD entry which matches the packet.<p>
Inbound packets must be checked against the inbound SPD and outbound packets must be checked against the outbound SPD.<p>
Implementation<p>
This function checks all the selector fields of the SPD table. The port numbers are only checked if the protocol is TCP or UDP. An entry which has a value of 0 is the same as the '*' which means everything.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>header</em>&nbsp;</td><td>Pointer to an IP packet which is checked </td></tr>
    <tr><td valign=top><em>table</em>&nbsp;</td><td>Pointer to the SPD inbound/outbound table </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Pointer to the matching SPD entry <p>
NULL if no entry matched </dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>port checking should be implemnted also </dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l00597">597</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="sa.h::ipsec_spd_print" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void ipsec_spd_print </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structspd__table__struct.html">spd_table</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>table</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Prints a Security Policy Database.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>table</em>&nbsp;</td><td>pointer to the SPD table </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>void </dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l00726">726</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="sa.h::ipsec_spd_print_single" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void ipsec_spd_print_single </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structspd__entry__struct.html">spd_entry</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>entry</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Prints a single SPD entry.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>entry</em>&nbsp;</td><td>pointer to the SPD entry </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>void </dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l00656">656</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="sa.h::ipsec_spd_release_dbs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="types_8h.html#a6">ipsec_status</a> ipsec_spd_release_dbs </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structdb__set__netif__struct.html">db_set_netif</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dbs</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is used to release the structure allocated in <a class="el" href="sa_8c.html#a2">ipsec_spd_load_dbs()</a>. The tables which were allocated in <a class="el" href="sa_8c.html#a2">ipsec_spd_load_dbs()</a> can now be freely used.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dbs</em>&nbsp;</td><td>pointer to the set of databases got by <a class="el" href="sa_8c.html#a2">ipsec_spd_load_dbs()</a> which has to be released </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>IPSEC_STATUS_SUCCESS if release was successful <p>
IPSEC_STATUS_FAILURE if release was not successful </dd></dl>

<p>
Definition at line <a class="el" href="sa_8c-source.html#l00336">336</a> of file <a class="el" href="sa_8c-source.html">sa.c</a>.    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a26" doxytag="sa.h::auth_alg" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="sa_8h.html#a26">auth_alg</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="sa_8h-source.html#l00169">169</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="sa.h::enc_alg" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="sa_8h.html#a25">enc_alg</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="sa_8h-source.html#l00169">169</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="sa.h::mode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="sa_8h.html#a24">mode</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="sa_8h-source.html#l00169">169</a> of file <a class="el" href="sa_8h-source.html">sa.h</a>.    </td>
  </tr>
</table>
	</td>
  </tr>
</table>
<hr>
<div align="center">Copyright 2003 by Christian Scheurer and Niklaus Schild</div>
</html>
