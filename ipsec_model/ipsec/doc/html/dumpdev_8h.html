<html>
<head>
<title>embedded IPsec - IPsec library</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="doxygen.css" type="text/css">
</head>

<body bgcolor="#FFFFFF" text="#000000">
<table width="98%" border="0" align="center">
  <tr>
    <td>
      <h2 align="left"><img src="logo_small.gif" alt="embedded IPsec"> source 
        code documentation </h2>
<hr>

<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>dumpdev.h File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Header file fof the dummy network adapter. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Christian Scheurer &lt;<a href="http://www.christianscheurer.ch">http://www.christianscheurer.ch</a>&gt;</dd></dl>
This document is part of <em>embedded IPsec<br>
 Copyright (c) 2003 Niklaus Schild and Christian Scheurer, HTI Biel/Bienne<br>
 All rights reserved.</em><hr>

<p>
Definition in file <a class="el" href="dumpdev_8h-source.html">dumpdev.h</a>.
<p>
<code>#include "lwip/netif.h"</code><br>

<p>
<a href="dumpdev_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="structdumpdev__stats.html">dumpdev_stats</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>err_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="dumpdev_8h.html#a0">dumpdev_init</a> (struct netif *)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>err_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="dumpdev_8h.html#a1">dumpdev_output</a> (struct netif *, struct pbuf *, struct ip_addr *)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>err_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="dumpdev_8h.html#a2">dumpdev_netlink_output</a> (struct netif *netif, struct pbuf *p)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="dumpdev_8h.html#a3">dumpdev_input</a> (struct netif *)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="dumpdev_8h.html#a4">dumpdev_service</a> (struct netif *)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a0" doxytag="dumpdev.h::dumpdev_init" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> err_t dumpdev_init </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct netif *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>netif</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialize the dump network device<p>
This function must be called prior to any other operation with this device. It sets the device name, MAC address, initializes statistics and performs general configuration of the "dumpdev" device.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>netif</em>&nbsp;</td><td>lwIP network interface data structure for this device. The structure must be initialized with IP, netmask and gateway address. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>err_t return code </dd></dl>

<p>
Definition at line <a class="el" href="dumpdev_8c-source.html#l00389">389</a> of file <a class="el" href="dumpdev_8c-source.html">dumpdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="dumpdev.h::dumpdev_input" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void dumpdev_input </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct netif *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>netif</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is used to transfer a received packet in newly allocated pbuf-memory and pass it to upper protocol layers.<p>
Note: this is the place where the dumped packets are injected and passed to higher protocol layers. It simulates the reception of a packet over the physical connection.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>netif</em>&nbsp;</td><td>initialized lwIP network interface data structure of this device </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>void</dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000018">Todo:</a></b></dt><dd>simulate reception of new packets HERE <p>
replace this loop with memcpy() <p>
ATTENTION: should be real IP, not -1</dd></dl>
<p>
If there is no INBOUND packet in the input queue, inject a sample ESP packet to check the stacks behavior 
<p>
Definition at line <a class="el" href="dumpdev_8c-source.html#l00215">215</a> of file <a class="el" href="dumpdev_8c-source.html">dumpdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="dumpdev.h::dumpdev_netlink_output" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> err_t dumpdev_netlink_output </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct netif *&nbsp;</td>
          <td class="mdname" nowrap> <em>netif</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct pbuf *&nbsp;</td>
          <td class="mdname" nowrap> <em>p</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function simulates the low-level network interface<p>
Note: This function does currently nothing but return ERR_OK<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>netif</em>&nbsp;</td><td>initialized lwIP network interface data structure of this device </td></tr>
    <tr><td valign=top><em>p</em>&nbsp;</td><td>pbuf containing a complete Ethernet frame as payload </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>err_t status </dd></dl>

<p>
Definition at line <a class="el" href="dumpdev_8c-source.html#l00368">368</a> of file <a class="el" href="dumpdev_8c-source.html">dumpdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="dumpdev.h::dumpdev_output" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> err_t dumpdev_output </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct netif *&nbsp;</td>
          <td class="mdname" nowrap> <em>netif</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct pbuf *&nbsp;</td>
          <td class="mdname" nowrap> <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct ip_addr *&nbsp;</td>
          <td class="mdname" nowrap> <em>ipaddr</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is used to send a packet out of the network device.<p>
Before dumping the frame (which is equivalent to sending data over the wire in a real Ethernet driver), the MAC address must be resolved using the ARP module. After the MAC address has been found, the packet will be "sent" (dumped).<p>
Note: this is the place where an automated check of outbound data can be added.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>netif</em>&nbsp;</td><td>initialized lwIP network interface data structure of this device </td></tr>
    <tr><td valign=top><em>p</em>&nbsp;</td><td>pbuf containing a complete Ethernet frame as payload </td></tr>
    <tr><td valign=top><em>ipaddr</em>&nbsp;</td><td>destination address </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>err_t status </dd></dl>

<p>
Definition at line <a class="el" href="dumpdev_8c-source.html#l00341">341</a> of file <a class="el" href="dumpdev_8c-source.html">dumpdev.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="dumpdev.h::dumpdev_service" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void dumpdev_service </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct netif *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>netif</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function must be called at regular intervals (i.g. 20 times per second). It will allow the dump device driver to perform pending operations, such as emptying the transmit buffer or feeding newly received data into the TCP/IP stack.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>netif</em>&nbsp;</td><td>initialized lwIP network interface data structure of this device </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>void </dd></dl>

<p>
Definition at line <a class="el" href="dumpdev_8c-source.html#l00198">198</a> of file <a class="el" href="dumpdev_8c-source.html">dumpdev.c</a>.    </td>
  </tr>
</table>
	</td>
  </tr>
</table>
<hr>
<div align="center">Copyright 2003 by Christian Scheurer and Niklaus Schild</div>
</html>
