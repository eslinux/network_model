
<html>
<head>
<title>lwIP</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="doxygen.css" type="text/css">
</head>

<body bgcolor="#FFFFFF" text="#000000">
<table width="98%" border="0" align="center">
  <tr>
    <td>
      <h2>lwIP code documentation</h2>
<hr>

<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>netif.c</h1><a href="netif_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00007 <span class="comment">/*</span>
00008 <span class="comment"> * Copyright (c) 2001-2003 Swedish Institute of Computer Science.</span>
00009 <span class="comment"> * All rights reserved.</span>
00010 <span class="comment"> *</span>
00011 <span class="comment"> * Redistribution and use in source and binary forms, with or without modification,</span>
00012 <span class="comment"> * are permitted provided that the following conditions are met:</span>
00013 <span class="comment"> *</span>
00014 <span class="comment"> * 1. Redistributions of source code must retain the above copyright notice,</span>
00015 <span class="comment"> *    this list of conditions and the following disclaimer.</span>
00016 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright notice,</span>
00017 <span class="comment"> *    this list of conditions and the following disclaimer in the documentation</span>
00018 <span class="comment"> *    and/or other materials provided with the distribution.</span>
00019 <span class="comment"> * 3. The name of the author may not be used to endorse or promote products</span>
00020 <span class="comment"> *    derived from this software without specific prior written permission.</span>
00021 <span class="comment"> *</span>
00022 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED</span>
00023 <span class="comment"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF</span>
00024 <span class="comment"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT</span>
00025 <span class="comment"> * SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,</span>
00026 <span class="comment"> * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT</span>
00027 <span class="comment"> * OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span>
00028 <span class="comment"> * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span>
00029 <span class="comment"> * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING</span>
00030 <span class="comment"> * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY</span>
00031 <span class="comment"> * OF SUCH DAMAGE.</span>
00032 <span class="comment"> *</span>
00033 <span class="comment"> * This file is part of the lwIP TCP/IP stack.</span>
00034 <span class="comment"> *</span>
00035 <span class="comment"> * Author: Adam Dunkels &lt;adam@sics.se&gt;</span>
00036 <span class="comment"> *</span>
00037 <span class="comment"> */</span>
00038 
00039 <span class="preprocessor">#include "<a class="code" href="opt_8h.html">lwip/opt.h</a>"</span>
00040 
00041 <span class="preprocessor">#include "<a class="code" href="def_8h.html">lwip/def.h</a>"</span>
00042 <span class="preprocessor">#include "<a class="code" href="mem_8h.html">lwip/mem.h</a>"</span>
00043 <span class="preprocessor">#include "<a class="code" href="netif_8h.html">lwip/netif.h</a>"</span>
00044 <span class="preprocessor">#include "lwip/ip_addr.h"</span>
00045 <span class="preprocessor">#include "<a class="code" href="tcp_8h.html">lwip/tcp.h</a>"</span>
00046 
00047 
<a name="l00048"></a><a class="code" href="netif_8c.html#a0">00048</a> <span class="keyword">struct </span><a class="code" href="structnetif.html">netif</a> *<a class="code" href="netif_8c.html#a0">netif_list</a> = <a class="code" href="def_8h.html#a2">NULL</a>;
<a name="l00049"></a><a class="code" href="netif_8c.html#a1">00049</a> <span class="keyword">struct </span><a class="code" href="structnetif.html">netif</a> *<a class="code" href="netif_8c.html#a1">netif_default</a> = <a class="code" href="def_8h.html#a2">NULL</a>;
00050 
00063 <span class="keyword">struct </span><a class="code" href="structnetif.html">netif</a> *
<a name="l00064"></a><a class="code" href="netif_8c.html#a2">00064</a> <a class="code" href="netif_8c.html#a2">netif_add</a>(<span class="keyword">struct</span> <a class="code" href="structip__addr.html">ip_addr</a> *ipaddr, <span class="keyword">struct</span> <a class="code" href="structip__addr.html">ip_addr</a> *netmask,
00065   <span class="keyword">struct</span> <a class="code" href="structip__addr.html">ip_addr</a> *gw,
00066   <span class="keywordtype">void</span> *state,
00067   <a class="code" href="err_8h.html#a13">err_t</a> (* init)(<span class="keyword">struct</span> <a class="code" href="structnetif.html">netif</a> *<a class="code" href="structnetif.html">netif</a>),
00068   <a class="code" href="err_8h.html#a13">err_t</a> (* input)(<span class="keyword">struct</span> <a class="code" href="structpbuf.html">pbuf</a> *p, <span class="keyword">struct</span> netif *netif))
00069 {
00070   <span class="keyword">struct </span>netif *netif;
00071   <span class="keyword">static</span> <span class="keywordtype">int</span> netifnum = 0;
00072 
00073   <span class="comment">/* allocate netif structure */</span>
00074   netif = <a class="code" href="mem_8c.html#a11">mem_malloc</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> netif));
00075 
00076   <span class="keywordflow">if</span> (netif == <a class="code" href="def_8h.html#a2">NULL</a>) {
00077     <a class="code" href="debug_8h.html#a12">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a>, (<span class="stringliteral">"netif_add(): out of memory for netif\n"</span>));
00078     <span class="keywordflow">return</span> <a class="code" href="def_8h.html#a2">NULL</a>;
00079   }
00080 <span class="preprocessor">#if LWIP_DHCP</span>
00081 <span class="preprocessor"></span>  <span class="comment">/* netif not under DHCP control by default */</span>
00082   netif-&gt;dhcp = <a class="code" href="def_8h.html#a2">NULL</a>;
00083 <span class="preprocessor">#endif</span>
00084 <span class="preprocessor"></span>  <span class="comment">/* remember netif specific state information data */</span>
00085   netif-&gt;<a class="code" href="structnetif.html#o7">state</a> = state;
00086   netif-&gt;<a class="code" href="structnetif.html#o12">num</a> = netifnum++;
00087   netif-&gt;<a class="code" href="structnetif.html#o4">input</a> = input;
00088 
00089   <a class="code" href="netif_8c.html#a3">netif_set_addr</a>(netif, ipaddr, netmask, gw);
00090 
00091   <span class="comment">/* call user specified initialization function for netif */</span>
00092   <span class="keywordflow">if</span> (init(netif) != <a class="code" href="err_8h.html#a0">ERR_OK</a>) {
00093     <a class="code" href="mem_8c.html#a8">mem_free</a>(netif);
00094     <span class="keywordflow">return</span> <a class="code" href="def_8h.html#a2">NULL</a>;
00095   }
00096 
00097   <span class="comment">/* add this netif to the list */</span>
00098   netif-&gt;<a class="code" href="structnetif.html#o0">next</a> = <a class="code" href="netif_8c.html#a0">netif_list</a>;
00099   <a class="code" href="netif_8c.html#a0">netif_list</a> = netif;
00100 <span class="preprocessor">#if NETIF_DEBUG</span>
00101 <span class="preprocessor"></span>  <a class="code" href="debug_8h.html#a12">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a>, (<span class="stringliteral">"netif: added interface %c%c IP addr "</span>,
00102     netif-&gt;name[0], netif-&gt;name[1]));
00103   <a class="code" href="ipv4_2lwip_2ip__addr_8h.html#a33">ip_addr_debug_print</a>(<a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a>, ipaddr);
00104   <a class="code" href="debug_8h.html#a12">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a>, (<span class="stringliteral">" netmask "</span>));
00105   <a class="code" href="ipv4_2lwip_2ip__addr_8h.html#a33">ip_addr_debug_print</a>(<a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a>, netmask);
00106   <a class="code" href="debug_8h.html#a12">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a>, (<span class="stringliteral">" gw "</span>));
00107   <a class="code" href="ipv4_2lwip_2ip__addr_8h.html#a33">ip_addr_debug_print</a>(<a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a>, gw);
00108   <a class="code" href="debug_8h.html#a12">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a>, (<span class="stringliteral">"\n"</span>));
00109 <span class="preprocessor">#endif </span><span class="comment">/* NETIF_DEBUG */</span>
00110   <span class="keywordflow">return</span> netif;
00111 }
00112 
00113 <span class="keywordtype">void</span>
<a name="l00114"></a><a class="code" href="netif_8c.html#a3">00114</a> <a class="code" href="netif_8c.html#a3">netif_set_addr</a>(<span class="keyword">struct</span> netif *netif,<span class="keyword">struct</span> <a class="code" href="structip__addr.html">ip_addr</a> *ipaddr, <span class="keyword">struct</span> <a class="code" href="structip__addr.html">ip_addr</a> *netmask,
00115     <span class="keyword">struct</span> <a class="code" href="structip__addr.html">ip_addr</a> *gw)
00116 {
00117   <a class="code" href="netif_8c.html#a6">netif_set_ipaddr</a>(netif, ipaddr);
00118   <a class="code" href="netif_8c.html#a8">netif_set_netmask</a>(netif, netmask);
00119   <a class="code" href="netif_8c.html#a7">netif_set_gw</a>(netif, gw);
00120 }
00121 
<a name="l00122"></a><a class="code" href="netif_8c.html#a4">00122</a> <span class="keywordtype">void</span> <a class="code" href="netif_8c.html#a4">netif_remove</a>(<span class="keyword">struct</span> netif * netif)
00123 {
00124   <span class="keywordflow">if</span> ( netif == <a class="code" href="def_8h.html#a2">NULL</a> ) <span class="keywordflow">return</span>;
00125 
00126   <span class="comment">/*  is it the first netif? */</span>
00127   <span class="keywordflow">if</span> (<a class="code" href="netif_8c.html#a0">netif_list</a> == netif) {
00128     <a class="code" href="netif_8c.html#a0">netif_list</a> = netif-&gt;<a class="code" href="structnetif.html#o0">next</a>;
00129   }
00130   <span class="keywordflow">else</span> {
00131     <span class="comment">/*  look for netif further down the list */</span>
00132     <span class="keyword">struct </span>netif * tmpNetif;
00133     <span class="keywordflow">for</span> (tmpNetif = <a class="code" href="netif_8c.html#a0">netif_list</a>; tmpNetif != <a class="code" href="def_8h.html#a2">NULL</a>; tmpNetif = tmpNetif-&gt;next) {
00134       <span class="keywordflow">if</span> (tmpNetif-&gt;next == netif) {
00135         tmpNetif-&gt;<a class="code" href="structnetif.html#o0">next</a> = netif-&gt;<a class="code" href="structnetif.html#o0">next</a>;
00136         <span class="keywordflow">break</span>;
00137         }
00138     }
00139     <span class="keywordflow">if</span> (tmpNetif == <a class="code" href="def_8h.html#a2">NULL</a>)
00140       <span class="keywordflow">return</span>; <span class="comment">/*  we didn't find any netif today */</span>
00141   }
00142   <span class="comment">/* this netif is default? */</span>
00143   <span class="keywordflow">if</span> (<a class="code" href="netif_8c.html#a1">netif_default</a> == netif)
00144     <span class="comment">/* reset default netif */</span>
00145     <a class="code" href="netif_8c.html#a1">netif_default</a> = <a class="code" href="def_8h.html#a2">NULL</a>;
00146   <a class="code" href="debug_8h.html#a12">LWIP_DEBUGF</a>( <a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a>, (<span class="stringliteral">"netif_remove: removed netif\n"</span>) );
00147   <a class="code" href="mem_8c.html#a8">mem_free</a>( netif );
00148 }
00149 
00150 <span class="keyword">struct </span>netif *
<a name="l00151"></a><a class="code" href="netif_8c.html#a5">00151</a> <a class="code" href="netif_8c.html#a5">netif_find</a>(<span class="keywordtype">char</span> *name)
00152 {
00153   <span class="keyword">struct </span>netif *netif;
00154   u8_t num;
00155 
00156   <span class="keywordflow">if</span> (name == <a class="code" href="def_8h.html#a2">NULL</a>) {
00157     <span class="keywordflow">return</span> <a class="code" href="def_8h.html#a2">NULL</a>;
00158   }
00159 
00160   num = name[2] - <span class="charliteral">'0'</span>;
00161 
00162   <span class="keywordflow">for</span>(netif = <a class="code" href="netif_8c.html#a0">netif_list</a>; netif != <a class="code" href="def_8h.html#a2">NULL</a>; netif = netif-&gt;next) {
00163     <span class="keywordflow">if</span> (num == netif-&gt;num &amp;&amp;
00164        name[0] == netif-&gt;name[0] &amp;&amp;
00165        name[1] == netif-&gt;name[1]) {
00166       <a class="code" href="debug_8h.html#a12">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a>, (<span class="stringliteral">"netif_find: found %c%c\n"</span>, name[0], name[1]));
00167       <span class="keywordflow">return</span> netif;
00168     }
00169   }
00170   <a class="code" href="debug_8h.html#a12">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a>, (<span class="stringliteral">"netif_find: didn't find %c%c\n"</span>, name[0], name[1]));
00171   <span class="keywordflow">return</span> <a class="code" href="def_8h.html#a2">NULL</a>;
00172 }
00173 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00174 <span class="keywordtype">void</span>
<a name="l00175"></a><a class="code" href="netif_8c.html#a6">00175</a> <a class="code" href="netif_8c.html#a6">netif_set_ipaddr</a>(<span class="keyword">struct</span> netif *netif, <span class="keyword">struct</span> <a class="code" href="structip__addr.html">ip_addr</a> *ipaddr)
00176 {
00177   <span class="comment">/* TODO: Handling of obsolete pcbs */</span>
00178   <span class="comment">/* See:  http://mail.gnu.org/archive/html/lwip-users/2003-03/msg00118.html */</span>
00179 <span class="preprocessor">#if LWIP_TCP</span>
00180 <span class="preprocessor"></span>  <span class="keyword">struct </span><a class="code" href="structtcp__pcb.html">tcp_pcb</a> *pcb;
00181   <span class="keyword">struct </span><a class="code" href="structtcp__pcb__listen.html">tcp_pcb_listen</a> *lpcb;
00182 
00183   <span class="comment">/* address is actually being changed? */</span>
00184   <span class="keywordflow">if</span> ((<a class="code" href="ipv4_2lwip_2ip__addr_8h.html#a29">ip_addr_cmp</a>(ipaddr, &amp;(netif-&gt;<a class="code" href="structnetif.html#o1">ip_addr</a>))) == 0)
00185   {
00186     <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structtcp__pcb.html">tcp_pcb</a> *<a class="code" href="tcp_8h.html#a50">tcp_active_pcbs</a>;
00187     <a class="code" href="debug_8h.html#a12">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a> | 1, (<span class="stringliteral">"netif_set_ipaddr: netif address being changed\n"</span>));
00188     pcb = <a class="code" href="tcp_8h.html#a50">tcp_active_pcbs</a>;
00189     <span class="keywordflow">while</span> (pcb != <a class="code" href="def_8h.html#a2">NULL</a>) {
00190       <span class="comment">/* PCB bound to current local interface address? */</span>
00191       <span class="keywordflow">if</span> (<a class="code" href="ipv4_2lwip_2ip__addr_8h.html#a29">ip_addr_cmp</a>(&amp;(pcb-&gt;local_ip), &amp;(netif-&gt;<a class="code" href="structnetif.html#o1">ip_addr</a>))) {
00192         <span class="comment">/* this connection must be aborted */</span>
00193         <span class="keyword">struct </span><a class="code" href="structtcp__pcb.html">tcp_pcb</a> *next = pcb-&gt;<a class="code" href="structtcp__pcb.html#o0">next</a>;
00194         <a class="code" href="debug_8h.html#a12">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a> | 1, (<span class="stringliteral">"netif_set_ipaddr: aborting pcb %p\n"</span>, (<span class="keywordtype">void</span> *)pcb));
00195         <a class="code" href="tcp_8h.html#a78">tcp_abort</a>(pcb);
00196         pcb = next;
00197       } <span class="keywordflow">else</span> {
00198         pcb = pcb-&gt;next;
00199       }
00200     }
00201     <span class="keywordflow">for</span> (lpcb = <a class="code" href="tcp_8h.html#a49">tcp_listen_pcbs</a>; lpcb != <a class="code" href="def_8h.html#a2">NULL</a>; lpcb = lpcb-&gt;next) {
00202       <span class="comment">/* PCB bound to current local interface address? */</span>
00203       <span class="keywordflow">if</span> (<a class="code" href="ipv4_2lwip_2ip__addr_8h.html#a29">ip_addr_cmp</a>(&amp;(lpcb-&gt;local_ip), &amp;(netif-&gt;<a class="code" href="structnetif.html#o1">ip_addr</a>))) {
00204         <span class="comment">/* The PCB is listening to the old ipaddr and</span>
00205 <span class="comment">         * is set to listen to the new one instead</span>
00206 <span class="comment">         * TODO: how do we know it is _listening_? */</span>
00207         <a class="code" href="ipv4_2lwip_2ip__addr_8h.html#a27">ip_addr_set</a>(&amp;(lpcb-&gt;local_ip), ipaddr);
00208       }
00209     }
00210   }
00211 <span class="preprocessor">#endif</span>
00212 <span class="preprocessor"></span>  <a class="code" href="ipv4_2lwip_2ip__addr_8h.html#a27">ip_addr_set</a>(&amp;(netif-&gt;<a class="code" href="structnetif.html#o1">ip_addr</a>), ipaddr);
00213   <a class="code" href="debug_8h.html#a12">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a> | <a class="code" href="debug_8h.html#a7">DBG_TRACE</a> | <a class="code" href="debug_8h.html#a8">DBG_STATE</a> | 3, (<span class="stringliteral">"netif: IP address of interface %c%c set to %u.%u.%u.%u\n"</span>,
00214     netif-&gt;<a class="code" href="structnetif.html#o11">name</a>[0], netif-&gt;<a class="code" href="structnetif.html#o11">name</a>[1],
00215     (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(<a class="code" href="ipv4_2lwip_2inet_8h.html#a3">ntohl</a>(netif-&gt;<a class="code" href="structnetif.html#o1">ip_addr</a>.<a class="code" href="structip__addr.html#o0">addr</a>) &gt;&gt; 24 &amp; 0xff),
00216     (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(<a class="code" href="ipv4_2lwip_2inet_8h.html#a3">ntohl</a>(netif-&gt;<a class="code" href="structnetif.html#o1">ip_addr</a>.<a class="code" href="structip__addr.html#o0">addr</a>) &gt;&gt; 16 &amp; 0xff),
00217     (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(<a class="code" href="ipv4_2lwip_2inet_8h.html#a3">ntohl</a>(netif-&gt;<a class="code" href="structnetif.html#o1">ip_addr</a>.<a class="code" href="structip__addr.html#o0">addr</a>) &gt;&gt; 8 &amp; 0xff),
00218     (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(<a class="code" href="ipv4_2lwip_2inet_8h.html#a3">ntohl</a>(netif-&gt;<a class="code" href="structnetif.html#o1">ip_addr</a>.<a class="code" href="structip__addr.html#o0">addr</a>) &amp; 0xff)));
00219 }
00220 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00221 <span class="keywordtype">void</span>
<a name="l00222"></a><a class="code" href="netif_8c.html#a7">00222</a> <a class="code" href="netif_8c.html#a7">netif_set_gw</a>(<span class="keyword">struct</span> netif *netif, <span class="keyword">struct</span> <a class="code" href="structip__addr.html">ip_addr</a> *gw)
00223 {
00224   <a class="code" href="ipv4_2lwip_2ip__addr_8h.html#a27">ip_addr_set</a>(&amp;(netif-&gt;<a class="code" href="structnetif.html#o3">gw</a>), gw);
00225   <a class="code" href="debug_8h.html#a12">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a> | <a class="code" href="debug_8h.html#a7">DBG_TRACE</a> | <a class="code" href="debug_8h.html#a8">DBG_STATE</a> | 3, (<span class="stringliteral">"netif: GW address of interface %c%c set to %u.%u.%u.%u\n"</span>,
00226            netif-&gt;<a class="code" href="structnetif.html#o11">name</a>[0], netif-&gt;<a class="code" href="structnetif.html#o11">name</a>[1],
00227            (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(<a class="code" href="ipv4_2lwip_2inet_8h.html#a3">ntohl</a>(netif-&gt;<a class="code" href="structnetif.html#o3">gw</a>.<a class="code" href="structip__addr.html#o0">addr</a>) &gt;&gt; 24 &amp; 0xff),
00228            (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(<a class="code" href="ipv4_2lwip_2inet_8h.html#a3">ntohl</a>(netif-&gt;<a class="code" href="structnetif.html#o3">gw</a>.<a class="code" href="structip__addr.html#o0">addr</a>) &gt;&gt; 16 &amp; 0xff),
00229            (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(<a class="code" href="ipv4_2lwip_2inet_8h.html#a3">ntohl</a>(netif-&gt;<a class="code" href="structnetif.html#o3">gw</a>.<a class="code" href="structip__addr.html#o0">addr</a>) &gt;&gt; 8 &amp; 0xff),
00230            (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(<a class="code" href="ipv4_2lwip_2inet_8h.html#a3">ntohl</a>(netif-&gt;<a class="code" href="structnetif.html#o3">gw</a>.<a class="code" href="structip__addr.html#o0">addr</a>) &amp; 0xff)));
00231 }
00232 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00233 <span class="keywordtype">void</span>
<a name="l00234"></a><a class="code" href="netif_8c.html#a8">00234</a> <a class="code" href="netif_8c.html#a8">netif_set_netmask</a>(<span class="keyword">struct</span> netif *netif, <span class="keyword">struct</span> <a class="code" href="structip__addr.html">ip_addr</a> *netmask)
00235 {
00236   <a class="code" href="ipv4_2lwip_2ip__addr_8h.html#a27">ip_addr_set</a>(&amp;(netif-&gt;<a class="code" href="structnetif.html#o2">netmask</a>), netmask);
00237   <a class="code" href="debug_8h.html#a12">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a> | <a class="code" href="debug_8h.html#a7">DBG_TRACE</a> | <a class="code" href="debug_8h.html#a8">DBG_STATE</a> | 3, (<span class="stringliteral">"netif: netmask of interface %c%c set to %u.%u.%u.%u\n"</span>,
00238            netif-&gt;<a class="code" href="structnetif.html#o11">name</a>[0], netif-&gt;<a class="code" href="structnetif.html#o11">name</a>[1],
00239            (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(<a class="code" href="ipv4_2lwip_2inet_8h.html#a3">ntohl</a>(netif-&gt;<a class="code" href="structnetif.html#o2">netmask</a>.<a class="code" href="structip__addr.html#o0">addr</a>) &gt;&gt; 24 &amp; 0xff),
00240            (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(<a class="code" href="ipv4_2lwip_2inet_8h.html#a3">ntohl</a>(netif-&gt;<a class="code" href="structnetif.html#o2">netmask</a>.<a class="code" href="structip__addr.html#o0">addr</a>) &gt;&gt; 16 &amp; 0xff),
00241            (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(<a class="code" href="ipv4_2lwip_2inet_8h.html#a3">ntohl</a>(netif-&gt;<a class="code" href="structnetif.html#o2">netmask</a>.<a class="code" href="structip__addr.html#o0">addr</a>) &gt;&gt; 8 &amp; 0xff),
00242            (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(<a class="code" href="ipv4_2lwip_2inet_8h.html#a3">ntohl</a>(netif-&gt;<a class="code" href="structnetif.html#o2">netmask</a>.<a class="code" href="structip__addr.html#o0">addr</a>) &amp; 0xff)));
00243 }
00244 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00245 <span class="keywordtype">void</span>
<a name="l00246"></a><a class="code" href="netif_8c.html#a9">00246</a> <a class="code" href="netif_8c.html#a9">netif_set_default</a>(<span class="keyword">struct</span> netif *netif)
00247 {
00248   <a class="code" href="netif_8c.html#a1">netif_default</a> = netif;
00249   <a class="code" href="debug_8h.html#a12">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a61">NETIF_DEBUG</a>, (<span class="stringliteral">"netif: setting default interface %c%c\n"</span>,
00250            netif ? netif-&gt;name[0] : <span class="charliteral">'\''</span>, netif ? netif-&gt;name[1] : <span class="charliteral">'\''</span>));
00251 }
00252 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00253 <span class="keywordtype">void</span>
<a name="l00254"></a><a class="code" href="netif_8c.html#a10">00254</a> <a class="code" href="netif_8c.html#a10">netif_init</a>(<span class="keywordtype">void</span>)
00255 {
00256   <a class="code" href="netif_8c.html#a0">netif_list</a> = <a class="code" href="netif_8c.html#a1">netif_default</a> = <a class="code" href="def_8h.html#a2">NULL</a>;
00257 }
00258 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
</pre></div>	</td>
  </tr>
</table>
<hr>
<div align="center">Copyright (c) 2001-2003 Swedish Institute of Computer Science</div>
</html>
