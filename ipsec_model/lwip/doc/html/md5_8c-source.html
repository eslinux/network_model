
<html>
<head>
<title>lwIP</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="doxygen.css" type="text/css">
</head>

<body bgcolor="#FFFFFF" text="#000000">
<table width="98%" border="0" align="center">
  <tr>
    <td>
      <h2>lwIP code documentation</h2>
<hr>

<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>md5.c</h1><a href="md5_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment"> ***********************************************************************</span>
00003 <span class="comment"> ** md5.c -- the source code for MD5 routines                         **</span>
00004 <span class="comment"> ** RSA Data Security, Inc. MD5 Message-Digest Algorithm              **</span>
00005 <span class="comment"> ** Created: 2/17/90 RLR                                              **</span>
00006 <span class="comment"> ** Revised: 1/91 SRD,AJ,BSK,JT Reference C ver., 7/10 constant corr. **</span>
00007 <span class="comment"> ***********************************************************************</span>
00008 <span class="comment"> */</span>
00009 
00010 <span class="comment">/*</span>
00011 <span class="comment"> ***********************************************************************</span>
00012 <span class="comment"> ** Copyright (C) 1990, RSA Data Security, Inc. All rights reserved.  **</span>
00013 <span class="comment"> **                                                                   **</span>
00014 <span class="comment"> ** License to copy and use this software is granted provided that    **</span>
00015 <span class="comment"> ** it is identified as the "RSA Data Security, Inc. MD5 Message-     **</span>
00016 <span class="comment"> ** Digest Algorithm" in all material mentioning or referencing this  **</span>
00017 <span class="comment"> ** software or this function.                                        **</span>
00018 <span class="comment"> **                                                                   **</span>
00019 <span class="comment"> ** License is also granted to make and use derivative works          **</span>
00020 <span class="comment"> ** provided that such works are identified as "derived from the RSA  **</span>
00021 <span class="comment"> ** Data Security, Inc. MD5 Message-Digest Algorithm" in all          **</span>
00022 <span class="comment"> ** material mentioning or referencing the derived work.              **</span>
00023 <span class="comment"> **                                                                   **</span>
00024 <span class="comment"> ** RSA Data Security, Inc. makes no representations concerning       **</span>
00025 <span class="comment"> ** either the merchantability of this software or the suitability    **</span>
00026 <span class="comment"> ** of this software for any particular purpose.  It is provided "as  **</span>
00027 <span class="comment"> ** is" without express or implied warranty of any kind.              **</span>
00028 <span class="comment"> **                                                                   **</span>
00029 <span class="comment"> ** These notices must be retained in any copies of any part of this  **</span>
00030 <span class="comment"> ** documentation and/or software.                                    **</span>
00031 <span class="comment"> ***********************************************************************</span>
00032 <span class="comment"> */</span>
00033 
00034 <span class="preprocessor">#include "<a class="code" href="ppp_8h.html">ppp.h</a>"</span>
00035 <span class="preprocessor">#include "<a class="code" href="md5_8h.html">md5.h</a>"</span>
00036 <span class="preprocessor">#include "<a class="code" href="pppdebug_8h.html">pppdebug.h</a>"</span>
00037 
00038 <span class="preprocessor">#if CHAP_SUPPORT &gt; 0 || MD5_SUPPORT &gt; 0</span>
00039 <span class="preprocessor"></span>
00040 <span class="comment">/*</span>
00041 <span class="comment"> ***********************************************************************</span>
00042 <span class="comment"> **  Message-digest routines:                                         **</span>
00043 <span class="comment"> **  To form the message digest for a message M                       **</span>
00044 <span class="comment"> **    (1) Initialize a context buffer mdContext using MD5Init        **</span>
00045 <span class="comment"> **    (2) Call MD5Update on mdContext and M                          **</span>
00046 <span class="comment"> **    (3) Call MD5Final on mdContext                                 **</span>
00047 <span class="comment"> **  The message digest is now in mdContext-&gt;digest[0...15]           **</span>
00048 <span class="comment"> ***********************************************************************</span>
00049 <span class="comment"> */</span>
00050 
00051 <span class="comment">/* forward declaration */</span>
00052 <span class="keyword">static</span> <span class="keywordtype">void</span> Transform (u32_t *buf, u32_t *in);
00053 
00054 <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> PADDING[64] = {
00055   0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
00056   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
00057   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
00058   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
00059   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
00060   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
00061   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
00062   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
00063 };
00064 
00065 <span class="comment">/* F, G, H and I are basic MD5 functions */</span>
00066 <span class="preprocessor">#define F(x, y, z) (((x) &amp; (y)) | ((~x) &amp; (z)))</span>
00067 <span class="preprocessor"></span><span class="preprocessor">#define G(x, y, z) (((x) &amp; (z)) | ((y) &amp; (~z)))</span>
00068 <span class="preprocessor"></span><span class="preprocessor">#define H(x, y, z) ((x) ^ (y) ^ (z))</span>
00069 <span class="preprocessor"></span><span class="preprocessor">#define I(x, y, z) ((y) ^ ((x) | (~z)))</span>
00070 <span class="preprocessor"></span>
00071 <span class="comment">/* ROTATE_LEFT rotates x left n bits */</span>
00072 <span class="preprocessor">#define ROTATE_LEFT(x, n) (((x) &lt;&lt; (n)) | ((x) &gt;&gt; (32-(n))))</span>
00073 <span class="preprocessor"></span>
00074 <span class="comment">/* FF, GG, HH, and II transformations for rounds 1, 2, 3, and 4 */</span>
00075 <span class="comment">/* Rotation is separate from addition to prevent recomputation */</span>
00076 <span class="preprocessor">#define FF(a, b, c, d, x, s, ac) \</span>
00077 <span class="preprocessor">  {(a) += F ((b), (c), (d)) + (x) + (u32_t)(ac); \</span>
00078 <span class="preprocessor">   (a) = ROTATE_LEFT ((a), (s)); \</span>
00079 <span class="preprocessor">   (a) += (b); \</span>
00080 <span class="preprocessor">  }</span>
00081 <span class="preprocessor"></span><span class="preprocessor">#define GG(a, b, c, d, x, s, ac) \</span>
00082 <span class="preprocessor">  {(a) += G ((b), (c), (d)) + (x) + (u32_t)(ac); \</span>
00083 <span class="preprocessor">   (a) = ROTATE_LEFT ((a), (s)); \</span>
00084 <span class="preprocessor">   (a) += (b); \</span>
00085 <span class="preprocessor">  }</span>
00086 <span class="preprocessor"></span><span class="preprocessor">#define HH(a, b, c, d, x, s, ac) \</span>
00087 <span class="preprocessor">  {(a) += H ((b), (c), (d)) + (x) + (u32_t)(ac); \</span>
00088 <span class="preprocessor">   (a) = ROTATE_LEFT ((a), (s)); \</span>
00089 <span class="preprocessor">   (a) += (b); \</span>
00090 <span class="preprocessor">  }</span>
00091 <span class="preprocessor"></span><span class="preprocessor">#define II(a, b, c, d, x, s, ac) \</span>
00092 <span class="preprocessor">  {(a) += I ((b), (c), (d)) + (x) + (u32_t)(ac); \</span>
00093 <span class="preprocessor">   (a) = ROTATE_LEFT ((a), (s)); \</span>
00094 <span class="preprocessor">   (a) += (b); \</span>
00095 <span class="preprocessor">  }</span>
00096 <span class="preprocessor"></span>
00097 <span class="preprocessor">#ifdef __STDC__</span>
00098 <span class="preprocessor"></span><span class="preprocessor">#define UL(x)   x##UL</span>
00099 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00100 <span class="preprocessor"></span><span class="preprocessor">#ifdef WIN32</span>
00101 <span class="preprocessor"></span><span class="preprocessor">#define UL(x)   x##UL</span>
00102 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00103 <span class="preprocessor"></span><span class="preprocessor">#define UL(x)   x</span>
00104 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00105 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00106 <span class="preprocessor"></span>
00107 <span class="comment">/* The routine MD5Init initializes the message-digest context</span>
00108 <span class="comment">   mdContext. All fields are set to zero.</span>
00109 <span class="comment"> */</span>
00110 <span class="keywordtype">void</span> <a class="code" href="md5_8h.html#a0">MD5Init</a> (<a class="code" href="structMD5__CTX.html">MD5_CTX</a> *mdContext)
00111 {
00112   mdContext-&gt;<a class="code" href="structMD5__CTX.html#o0">i</a>[0] = mdContext-&gt;<a class="code" href="structMD5__CTX.html#o0">i</a>[1] = (u32_t)0;
00113 
00114   <span class="comment">/* Load magic initialization constants.</span>
00115 <span class="comment">   */</span>
00116   mdContext-&gt;<a class="code" href="structMD5__CTX.html#o1">buf</a>[0] = (u32_t)0x67452301UL;
00117   mdContext-&gt;<a class="code" href="structMD5__CTX.html#o1">buf</a>[1] = (u32_t)0xefcdab89UL;
00118   mdContext-&gt;<a class="code" href="structMD5__CTX.html#o1">buf</a>[2] = (u32_t)0x98badcfeUL;
00119   mdContext-&gt;<a class="code" href="structMD5__CTX.html#o1">buf</a>[3] = (u32_t)0x10325476UL;
00120 }
00121 
00122 <span class="comment">/* The routine MD5Update updates the message-digest context to</span>
00123 <span class="comment">   account for the presence of each of the characters inBuf[0..inLen-1]</span>
00124 <span class="comment">   in the message whose digest is being computed.</span>
00125 <span class="comment"> */</span>
00126 <span class="keywordtype">void</span> <a class="code" href="md5_8h.html#a1">MD5Update</a>(<a class="code" href="structMD5__CTX.html">MD5_CTX</a> *mdContext, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *inBuf, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inLen)
00127 {
00128   u32_t in[16];
00129   <span class="keywordtype">int</span> mdi;
00130   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, ii;
00131 
00132 <span class="preprocessor">#if 0</span>
00133 <span class="preprocessor"></span>  <a class="code" href="pppdebug_8h.html#a15">ppp_trace</a>(LOG_INFO, <span class="stringliteral">"MD5Update: %u:%.*H\n"</span>, inLen, MIN(inLen, 20) * 2, inBuf);
00134   <a class="code" href="pppdebug_8h.html#a15">ppp_trace</a>(LOG_INFO, <span class="stringliteral">"MD5Update: %u:%s\n"</span>, inLen, inBuf);
00135 <span class="preprocessor">#endif</span>
00136 <span class="preprocessor"></span>  
00137   <span class="comment">/* compute number of bytes mod 64 */</span>
00138   mdi = (<span class="keywordtype">int</span>)((mdContext-&gt;<a class="code" href="structMD5__CTX.html#o0">i</a>[0] &gt;&gt; 3) &amp; 0x3F);
00139 
00140   <span class="comment">/* update number of bits */</span>
00141   <span class="keywordflow">if</span> ((mdContext-&gt;<a class="code" href="structMD5__CTX.html#o0">i</a>[0] + ((u32_t)inLen &lt;&lt; 3)) &lt; mdContext-&gt;<a class="code" href="structMD5__CTX.html#o0">i</a>[0])
00142     mdContext-&gt;<a class="code" href="structMD5__CTX.html#o0">i</a>[1]++;
00143   mdContext-&gt;<a class="code" href="structMD5__CTX.html#o0">i</a>[0] += ((u32_t)inLen &lt;&lt; 3);
00144   mdContext-&gt;<a class="code" href="structMD5__CTX.html#o0">i</a>[1] += ((u32_t)inLen &gt;&gt; 29);
00145 
00146   <span class="keywordflow">while</span> (inLen--) {
00147     <span class="comment">/* add new character to buffer, increment mdi */</span>
00148     mdContext-&gt;<a class="code" href="structMD5__CTX.html#o2">in</a>[mdi++] = *inBuf++;
00149 
00150     <span class="comment">/* transform if necessary */</span>
00151     <span class="keywordflow">if</span> (mdi == 0x40) {
00152       <span class="keywordflow">for</span> (i = 0, ii = 0; i &lt; 16; i++, ii += 4)
00153         in[i] = (((u32_t)mdContext-&gt;<a class="code" href="structMD5__CTX.html#o2">in</a>[ii+3]) &lt;&lt; 24) |
00154                 (((u32_t)mdContext-&gt;<a class="code" href="structMD5__CTX.html#o2">in</a>[ii+2]) &lt;&lt; 16) |
00155                                 (((u32_t)mdContext-&gt;<a class="code" href="structMD5__CTX.html#o2">in</a>[ii+1]) &lt;&lt; 8) |
00156                 ((u32_t)mdContext-&gt;<a class="code" href="structMD5__CTX.html#o2">in</a>[ii]);
00157       Transform (mdContext-&gt;<a class="code" href="structMD5__CTX.html#o1">buf</a>, in);
00158       mdi = 0;
00159     }
00160   }
00161 }
00162 
00163 <span class="comment">/* The routine MD5Final terminates the message-digest computation and</span>
00164 <span class="comment">   ends with the desired message digest in mdContext-&gt;digest[0...15].</span>
00165 <span class="comment"> */</span>
00166 <span class="keywordtype">void</span> <a class="code" href="md5_8h.html#a2">MD5Final</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> hash[], <a class="code" href="structMD5__CTX.html">MD5_CTX</a> *mdContext)
00167 {
00168   u32_t in[16];
00169   <span class="keywordtype">int</span> mdi;
00170   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, ii;
00171   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> padLen;
00172 
00173   <span class="comment">/* save number of bits */</span>
00174   in[14] = mdContext-&gt;<a class="code" href="structMD5__CTX.html#o0">i</a>[0];
00175   in[15] = mdContext-&gt;<a class="code" href="structMD5__CTX.html#o0">i</a>[1];
00176 
00177   <span class="comment">/* compute number of bytes mod 64 */</span>
00178   mdi = (<span class="keywordtype">int</span>)((mdContext-&gt;<a class="code" href="structMD5__CTX.html#o0">i</a>[0] &gt;&gt; 3) &amp; 0x3F);
00179 
00180   <span class="comment">/* pad out to 56 mod 64 */</span>
00181   padLen = (mdi &lt; 56) ? (56 - mdi) : (120 - mdi);
00182   <a class="code" href="md5_8h.html#a1">MD5Update</a> (mdContext, PADDING, padLen);
00183 
00184   <span class="comment">/* append length in bits and transform */</span>
00185   <span class="keywordflow">for</span> (i = 0, ii = 0; i &lt; 14; i++, ii += 4)
00186     in[i] = (((u32_t)mdContext-&gt;<a class="code" href="structMD5__CTX.html#o2">in</a>[ii+3]) &lt;&lt; 24) |
00187             (((u32_t)mdContext-&gt;<a class="code" href="structMD5__CTX.html#o2">in</a>[ii+2]) &lt;&lt; 16) |
00188             (((u32_t)mdContext-&gt;<a class="code" href="structMD5__CTX.html#o2">in</a>[ii+1]) &lt;&lt; 8) |
00189             ((u32_t)mdContext-&gt;<a class="code" href="structMD5__CTX.html#o2">in</a>[ii]);
00190   Transform (mdContext-&gt;<a class="code" href="structMD5__CTX.html#o1">buf</a>, in);
00191 
00192   <span class="comment">/* store buffer in digest */</span>
00193   <span class="keywordflow">for</span> (i = 0, ii = 0; i &lt; 4; i++, ii += 4) {
00194     mdContext-&gt;<a class="code" href="structMD5__CTX.html#o3">digest</a>[ii] = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(mdContext-&gt;<a class="code" href="structMD5__CTX.html#o1">buf</a>[i] &amp; 0xFF);
00195         mdContext-&gt;<a class="code" href="structMD5__CTX.html#o3">digest</a>[ii+1] =
00196       (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)((mdContext-&gt;<a class="code" href="structMD5__CTX.html#o1">buf</a>[i] &gt;&gt; 8) &amp; 0xFF);
00197     mdContext-&gt;<a class="code" href="structMD5__CTX.html#o3">digest</a>[ii+2] =
00198       (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)((mdContext-&gt;<a class="code" href="structMD5__CTX.html#o1">buf</a>[i] &gt;&gt; 16) &amp; 0xFF);
00199     mdContext-&gt;<a class="code" href="structMD5__CTX.html#o3">digest</a>[ii+3] =
00200       (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)((mdContext-&gt;<a class="code" href="structMD5__CTX.html#o1">buf</a>[i] &gt;&gt; 24) &amp; 0xFF);
00201   }
00202   memcpy(hash, mdContext-&gt;<a class="code" href="structMD5__CTX.html#o3">digest</a>, 16);
00203 }
00204 
00205 <span class="comment">/* Basic MD5 step. Transforms buf based on in.</span>
00206 <span class="comment"> */</span>
00207 <span class="keyword">static</span> <span class="keywordtype">void</span> Transform (u32_t *buf, u32_t *in)
00208 {
00209   u32_t a = buf[0], b = buf[1], c = buf[2], d = buf[3];
00210 
00211   <span class="comment">/* Round 1 */</span>
00212 <span class="preprocessor">#define S11 7</span>
00213 <span class="preprocessor"></span><span class="preprocessor">#define S12 12</span>
00214 <span class="preprocessor"></span><span class="preprocessor">#define S13 17</span>
00215 <span class="preprocessor"></span><span class="preprocessor">#define S14 22</span>
00216 <span class="preprocessor"></span>  FF ( a, b, c, d, in[ 0], S11, UL(3614090360)); <span class="comment">/* 1 */</span>
00217   FF ( d, a, b, c, in[ 1], S12, UL(3905402710)); <span class="comment">/* 2 */</span>
00218   FF ( c, d, a, b, in[ 2], S13, UL( 606105819)); <span class="comment">/* 3 */</span>
00219   FF ( b, c, d, a, in[ 3], S14, UL(3250441966)); <span class="comment">/* 4 */</span>
00220   FF ( a, b, c, d, in[ 4], S11, UL(4118548399)); <span class="comment">/* 5 */</span>
00221   FF ( d, a, b, c, in[ 5], S12, UL(1200080426)); <span class="comment">/* 6 */</span>
00222   FF ( c, d, a, b, in[ 6], S13, UL(2821735955)); <span class="comment">/* 7 */</span>
00223   FF ( b, c, d, a, in[ 7], S14, UL(4249261313)); <span class="comment">/* 8 */</span>
00224   FF ( a, b, c, d, in[ 8], S11, UL(1770035416)); <span class="comment">/* 9 */</span>
00225   FF ( d, a, b, c, in[ 9], S12, UL(2336552879)); <span class="comment">/* 10 */</span>
00226   FF ( c, d, a, b, in[10], S13, UL(4294925233)); <span class="comment">/* 11 */</span>
00227   FF ( b, c, d, a, in[11], S14, UL(2304563134)); <span class="comment">/* 12 */</span>
00228   FF ( a, b, c, d, in[12], S11, UL(1804603682)); <span class="comment">/* 13 */</span>
00229   FF ( d, a, b, c, in[13], S12, UL(4254626195)); <span class="comment">/* 14 */</span>
00230   FF ( c, d, a, b, in[14], S13, UL(2792965006)); <span class="comment">/* 15 */</span>
00231   FF ( b, c, d, a, in[15], S14, UL(1236535329)); <span class="comment">/* 16 */</span>
00232 
00233   <span class="comment">/* Round 2 */</span>
00234 <span class="preprocessor">#define S21 5</span>
00235 <span class="preprocessor"></span><span class="preprocessor">#define S22 9</span>
00236 <span class="preprocessor"></span><span class="preprocessor">#define S23 14</span>
00237 <span class="preprocessor"></span><span class="preprocessor">#define S24 20</span>
00238 <span class="preprocessor"></span>  GG ( a, b, c, d, in[ 1], S21, UL(4129170786)); <span class="comment">/* 17 */</span>
00239   GG ( d, a, b, c, in[ 6], S22, UL(3225465664)); <span class="comment">/* 18 */</span>
00240   GG ( c, d, a, b, in[11], S23, UL( 643717713)); <span class="comment">/* 19 */</span>
00241   GG ( b, c, d, a, in[ 0], S24, UL(3921069994)); <span class="comment">/* 20 */</span>
00242   GG ( a, b, c, d, in[ 5], S21, UL(3593408605)); <span class="comment">/* 21 */</span>
00243   GG ( d, a, b, c, in[10], S22, UL(  38016083)); <span class="comment">/* 22 */</span>
00244   GG ( c, d, a, b, in[15], S23, UL(3634488961)); <span class="comment">/* 23 */</span>
00245   GG ( b, c, d, a, in[ 4], S24, UL(3889429448)); <span class="comment">/* 24 */</span>
00246   GG ( a, b, c, d, in[ 9], S21, UL( 568446438)); <span class="comment">/* 25 */</span>
00247   GG ( d, a, b, c, in[14], S22, UL(3275163606)); <span class="comment">/* 26 */</span>
00248   GG ( c, d, a, b, in[ 3], S23, UL(4107603335)); <span class="comment">/* 27 */</span>
00249   GG ( b, c, d, a, in[ 8], S24, UL(1163531501)); <span class="comment">/* 28 */</span>
00250   GG ( a, b, c, d, in[13], S21, UL(2850285829)); <span class="comment">/* 29 */</span>
00251   GG ( d, a, b, c, in[ 2], S22, UL(4243563512)); <span class="comment">/* 30 */</span>
00252   GG ( c, d, a, b, in[ 7], S23, UL(1735328473)); <span class="comment">/* 31 */</span>
00253   GG ( b, c, d, a, in[12], S24, UL(2368359562)); <span class="comment">/* 32 */</span>
00254 
00255   <span class="comment">/* Round 3 */</span>
00256 <span class="preprocessor">#define S31 4</span>
00257 <span class="preprocessor"></span><span class="preprocessor">#define S32 11</span>
00258 <span class="preprocessor"></span><span class="preprocessor">#define S33 16</span>
00259 <span class="preprocessor"></span><span class="preprocessor">#define S34 23</span>
00260 <span class="preprocessor"></span>  HH ( a, b, c, d, in[ 5], S31, UL(4294588738)); <span class="comment">/* 33 */</span>
00261   HH ( d, a, b, c, in[ 8], S32, UL(2272392833)); <span class="comment">/* 34 */</span>
00262   HH ( c, d, a, b, in[11], S33, UL(1839030562)); <span class="comment">/* 35 */</span>
00263   HH ( b, c, d, a, in[14], S34, UL(4259657740)); <span class="comment">/* 36 */</span>
00264   HH ( a, b, c, d, in[ 1], S31, UL(2763975236)); <span class="comment">/* 37 */</span>
00265   HH ( d, a, b, c, in[ 4], S32, UL(1272893353)); <span class="comment">/* 38 */</span>
00266   HH ( c, d, a, b, in[ 7], S33, UL(4139469664)); <span class="comment">/* 39 */</span>
00267   HH ( b, c, d, a, in[10], S34, UL(3200236656)); <span class="comment">/* 40 */</span>
00268   HH ( a, b, c, d, in[13], S31, UL( 681279174)); <span class="comment">/* 41 */</span>
00269   HH ( d, a, b, c, in[ 0], S32, UL(3936430074)); <span class="comment">/* 42 */</span>
00270   HH ( c, d, a, b, in[ 3], S33, UL(3572445317)); <span class="comment">/* 43 */</span>
00271   HH ( b, c, d, a, in[ 6], S34, UL(  76029189)); <span class="comment">/* 44 */</span>
00272   HH ( a, b, c, d, in[ 9], S31, UL(3654602809)); <span class="comment">/* 45 */</span>
00273   HH ( d, a, b, c, in[12], S32, UL(3873151461)); <span class="comment">/* 46 */</span>
00274   HH ( c, d, a, b, in[15], S33, UL( 530742520)); <span class="comment">/* 47 */</span>
00275   HH ( b, c, d, a, in[ 2], S34, UL(3299628645)); <span class="comment">/* 48 */</span>
00276 
00277   <span class="comment">/* Round 4 */</span>
00278 <span class="preprocessor">#define S41 6</span>
00279 <span class="preprocessor"></span><span class="preprocessor">#define S42 10</span>
00280 <span class="preprocessor"></span><span class="preprocessor">#define S43 15</span>
00281 <span class="preprocessor"></span><span class="preprocessor">#define S44 21</span>
00282 <span class="preprocessor"></span>  II ( a, b, c, d, in[ 0], S41, UL(4096336452)); <span class="comment">/* 49 */</span>
00283   II ( d, a, b, c, in[ 7], S42, UL(1126891415)); <span class="comment">/* 50 */</span>
00284   II ( c, d, a, b, in[14], S43, UL(2878612391)); <span class="comment">/* 51 */</span>
00285   II ( b, c, d, a, in[ 5], S44, UL(4237533241)); <span class="comment">/* 52 */</span>
00286   II ( a, b, c, d, in[12], S41, UL(1700485571)); <span class="comment">/* 53 */</span>
00287   II ( d, a, b, c, in[ 3], S42, UL(2399980690)); <span class="comment">/* 54 */</span>
00288   II ( c, d, a, b, in[10], S43, UL(4293915773)); <span class="comment">/* 55 */</span>
00289   II ( b, c, d, a, in[ 1], S44, UL(2240044497)); <span class="comment">/* 56 */</span>
00290   II ( a, b, c, d, in[ 8], S41, UL(1873313359)); <span class="comment">/* 57 */</span>
00291   II ( d, a, b, c, in[15], S42, UL(4264355552)); <span class="comment">/* 58 */</span>
00292   II ( c, d, a, b, in[ 6], S43, UL(2734768916)); <span class="comment">/* 59 */</span>
00293   II ( b, c, d, a, in[13], S44, UL(1309151649)); <span class="comment">/* 60 */</span>
00294   II ( a, b, c, d, in[ 4], S41, UL(4149444226)); <span class="comment">/* 61 */</span>
00295   II ( d, a, b, c, in[11], S42, UL(3174756917)); <span class="comment">/* 62 */</span>
00296   II ( c, d, a, b, in[ 2], S43, UL( 718787259)); <span class="comment">/* 63 */</span>
00297   II ( b, c, d, a, in[ 9], S44, UL(3951481745)); <span class="comment">/* 64 */</span>
00298 
00299   buf[0] += a;
00300   buf[1] += b;
00301   buf[2] += c;
00302   buf[3] += d;
00303 }
00304 
00305 <span class="preprocessor">#endif</span>
00306 <span class="preprocessor"></span>
</pre></div>	</td>
  </tr>
</table>
<hr>
<div align="center">Copyright (c) 2001-2003 Swedish Institute of Computer Science</div>
</html>
