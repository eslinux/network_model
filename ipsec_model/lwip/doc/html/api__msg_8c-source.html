
<html>
<head>
<title>lwIP</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="doxygen.css" type="text/css">
</head>

<body bgcolor="#FFFFFF" text="#000000">
<table width="98%" border="0" align="center">
  <tr>
    <td>
      <h2>lwIP code documentation</h2>
<hr>

<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>api_msg.c</h1><a href="api__msg_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment"> * Copyright (c) 2001-2003 Swedish Institute of Computer Science.</span>
00003 <span class="comment"> * All rights reserved. </span>
00004 <span class="comment"> * </span>
00005 <span class="comment"> * Redistribution and use in source and binary forms, with or without modification, </span>
00006 <span class="comment"> * are permitted provided that the following conditions are met:</span>
00007 <span class="comment"> *</span>
00008 <span class="comment"> * 1. Redistributions of source code must retain the above copyright notice,</span>
00009 <span class="comment"> *    this list of conditions and the following disclaimer.</span>
00010 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright notice,</span>
00011 <span class="comment"> *    this list of conditions and the following disclaimer in the documentation</span>
00012 <span class="comment"> *    and/or other materials provided with the distribution.</span>
00013 <span class="comment"> * 3. The name of the author may not be used to endorse or promote products</span>
00014 <span class="comment"> *    derived from this software without specific prior written permission. </span>
00015 <span class="comment"> *</span>
00016 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED </span>
00017 <span class="comment"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
00018 <span class="comment"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT </span>
00019 <span class="comment"> * SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, </span>
00020 <span class="comment"> * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT </span>
00021 <span class="comment"> * OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS </span>
00022 <span class="comment"> * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN </span>
00023 <span class="comment"> * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING </span>
00024 <span class="comment"> * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY </span>
00025 <span class="comment"> * OF SUCH DAMAGE.</span>
00026 <span class="comment"> *</span>
00027 <span class="comment"> * This file is part of the lwIP TCP/IP stack.</span>
00028 <span class="comment"> * </span>
00029 <span class="comment"> * Author: Adam Dunkels &lt;adam@sics.se&gt;</span>
00030 <span class="comment"> *</span>
00031 <span class="comment"> */</span>
00032 
00033 <span class="preprocessor">#include "<a class="code" href="opt_8h.html">lwip/opt.h</a>"</span>
00034 <span class="preprocessor">#include "<a class="code" href="arch_8h.html">lwip/arch.h</a>"</span>
00035 <span class="preprocessor">#include "<a class="code" href="api__msg_8h.html">lwip/api_msg.h</a>"</span>
00036 <span class="preprocessor">#include "<a class="code" href="memp_8h.html">lwip/memp.h</a>"</span>
00037 <span class="preprocessor">#include "<a class="code" href="sys_8h.html">lwip/sys.h</a>"</span>
00038 <span class="preprocessor">#include "<a class="code" href="tcpip_8h.html">lwip/tcpip.h</a>"</span>
00039 
00040 <span class="preprocessor">#if LWIP_UDP</span>
00041 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span>
00042 recv_udp(<span class="keywordtype">void</span> *arg, <span class="keyword">struct</span> <a class="code" href="structudp__pcb.html">udp_pcb</a> *pcb, <span class="keyword">struct</span> <a class="code" href="structpbuf.html">pbuf</a> *p,
00043    <span class="keyword">struct</span> <a class="code" href="structip__addr.html">ip_addr</a> *addr, u16_t port)
00044 {
00045   <span class="keyword">struct </span><a class="code" href="structnetbuf.html">netbuf</a> *buf;
00046   <span class="keyword">struct </span><a class="code" href="structnetconn.html">netconn</a> *conn;
00047 
00048   conn = arg;
00049   
00050   <span class="keywordflow">if</span> (conn == <a class="code" href="def_8h.html#a2">NULL</a>) {
00051     <a class="code" href="pbuf_8c.html#a14">pbuf_free</a>(p);
00052     <span class="keywordflow">return</span>;
00053   }
00054   <span class="keywordflow">if</span> (conn-&gt;recvmbox != SYS_MBOX_NULL) {
00055     buf = <a class="code" href="memp_8c.html#a7">memp_mallocp</a>(MEMP_NETBUF);
00056     <span class="keywordflow">if</span> (buf == <a class="code" href="def_8h.html#a2">NULL</a>) {
00057       <a class="code" href="pbuf_8c.html#a14">pbuf_free</a>(p);
00058       <span class="keywordflow">return</span>;
00059     } <span class="keywordflow">else</span> {
00060       buf-&gt;p = p;
00061       buf-&gt;ptr = p;
00062       buf-&gt;fromaddr = addr;
00063       buf-&gt;fromport = port;
00064     }
00065 
00066   conn-&gt;recv_avail += p-&gt;<a class="code" href="structpbuf.html#o2">tot_len</a>;
00067     <span class="comment">/* Register event with callback */</span>
00068     <span class="keywordflow">if</span> (conn-&gt;callback)
00069         (*conn-&gt;callback)(conn, <a class="code" href="api_8h.html#a48a12">NETCONN_EVT_RCVPLUS</a>, p-&gt;<a class="code" href="structpbuf.html#o2">tot_len</a>);
00070     <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(conn-&gt;recvmbox, buf);
00071   }
00072 }
00073 <span class="preprocessor">#endif </span><span class="comment">/* LWIP_UDP */</span>
00074 <span class="preprocessor">#if LWIP_TCP</span>
00075 <span class="preprocessor"></span><span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00076 <span class="keyword">static</span> <a class="code" href="err_8h.html#a13">err_t</a>
00077 recv_tcp(<span class="keywordtype">void</span> *arg, <span class="keyword">struct</span> <a class="code" href="structtcp__pcb.html">tcp_pcb</a> *pcb, <span class="keyword">struct</span> <a class="code" href="structpbuf.html">pbuf</a> *p, <a class="code" href="err_8h.html#a13">err_t</a> err)
00078 {
00079   <span class="keyword">struct </span><a class="code" href="structnetconn.html">netconn</a> *conn;
00080   u16_t len;
00081   
00082   conn = arg;
00083 
00084   <span class="keywordflow">if</span> (conn == <a class="code" href="def_8h.html#a2">NULL</a>) {
00085     <a class="code" href="pbuf_8c.html#a14">pbuf_free</a>(p);
00086     <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a7">ERR_VAL</a>;
00087   }
00088 
00089   <span class="keywordflow">if</span> (conn-&gt;recvmbox != SYS_MBOX_NULL) {
00090         
00091     conn-&gt;err = err;
00092     <span class="keywordflow">if</span> (p != <a class="code" href="def_8h.html#a2">NULL</a>) {
00093         len = p-&gt;<a class="code" href="structpbuf.html#o2">tot_len</a>;
00094         conn-&gt;recv_avail += len;
00095     }
00096     <span class="keywordflow">else</span>
00097         len = 0;
00098     <span class="comment">/* Register event with callback */</span>
00099     <span class="keywordflow">if</span> (conn-&gt;callback)
00100         (*conn-&gt;callback)(conn, <a class="code" href="api_8h.html#a48a12">NETCONN_EVT_RCVPLUS</a>, len);
00101     <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(conn-&gt;recvmbox, p);
00102   }  
00103   <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a0">ERR_OK</a>;
00104 }
00105 
00106 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00107 <span class="keyword">static</span> <a class="code" href="err_8h.html#a13">err_t</a>
00108 poll_tcp(<span class="keywordtype">void</span> *arg, <span class="keyword">struct</span> <a class="code" href="structtcp__pcb.html">tcp_pcb</a> *pcb)
00109 {
00110   <span class="keyword">struct </span><a class="code" href="structnetconn.html">netconn</a> *conn;
00111 
00112   conn = arg;
00113   <span class="keywordflow">if</span> (conn != <a class="code" href="def_8h.html#a2">NULL</a> &amp;&amp;
00114      (conn-&gt;state == <a class="code" href="api_8h.html#a47a7">NETCONN_WRITE</a> || conn-&gt;state == <a class="code" href="api_8h.html#a47a11">NETCONN_CLOSE</a>) &amp;&amp;
00115      conn-&gt;sem != SYS_SEM_NULL) {
00116     <a class="code" href="sys_8h.html#a10">sys_sem_signal</a>(conn-&gt;sem);
00117   }
00118   <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a0">ERR_OK</a>;
00119 }
00120 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00121 <span class="keyword">static</span> <a class="code" href="err_8h.html#a13">err_t</a>
00122 sent_tcp(<span class="keywordtype">void</span> *arg, <span class="keyword">struct</span> <a class="code" href="structtcp__pcb.html">tcp_pcb</a> *pcb, u16_t len)
00123 {
00124   <span class="keyword">struct </span><a class="code" href="structnetconn.html">netconn</a> *conn;
00125 
00126   conn = arg;
00127   <span class="keywordflow">if</span> (conn != <a class="code" href="def_8h.html#a2">NULL</a> &amp;&amp; conn-&gt;sem != SYS_SEM_NULL) {
00128     <a class="code" href="sys_8h.html#a10">sys_sem_signal</a>(conn-&gt;sem);
00129   }
00130 
00131   <span class="keywordflow">if</span> (conn &amp;&amp; conn-&gt;callback)
00132       <span class="keywordflow">if</span> (<a class="code" href="tcp_8h.html#a1">tcp_sndbuf</a>(conn-&gt;pcb.tcp) &gt; <a class="code" href="opt_8h.html#a39">TCP_SNDLOWAT</a>)
00133           (*conn-&gt;callback)(conn, <a class="code" href="api_8h.html#a48a14">NETCONN_EVT_SENDPLUS</a>, len);
00134   
00135   <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a0">ERR_OK</a>;
00136 }
00137 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00138 <span class="keyword">static</span> <span class="keywordtype">void</span>
00139 err_tcp(<span class="keywordtype">void</span> *arg, <a class="code" href="err_8h.html#a13">err_t</a> err)
00140 {
00141   <span class="keyword">struct </span><a class="code" href="structnetconn.html">netconn</a> *conn;
00142 
00143   conn = arg;
00144 
00145   conn-&gt;pcb.tcp = <a class="code" href="def_8h.html#a2">NULL</a>;
00146 
00147   
00148   conn-&gt;err = err;
00149   <span class="keywordflow">if</span> (conn-&gt;recvmbox != SYS_MBOX_NULL) {
00150     <span class="comment">/* Register event with callback */</span>
00151     <span class="keywordflow">if</span> (conn-&gt;callback)
00152       (*conn-&gt;callback)(conn, <a class="code" href="api_8h.html#a48a12">NETCONN_EVT_RCVPLUS</a>, 0);
00153     <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(conn-&gt;recvmbox, NULL);
00154   }
00155   <span class="keywordflow">if</span> (conn-&gt;mbox != SYS_MBOX_NULL) {
00156     <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(conn-&gt;mbox, NULL);
00157   }
00158   <span class="keywordflow">if</span> (conn-&gt;acceptmbox != SYS_MBOX_NULL) {
00159      <span class="comment">/* Register event with callback */</span>
00160     <span class="keywordflow">if</span> (conn-&gt;callback)
00161       (*conn-&gt;callback)(conn, <a class="code" href="api_8h.html#a48a12">NETCONN_EVT_RCVPLUS</a>, 0);
00162     <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(conn-&gt;acceptmbox, NULL);
00163   }
00164   <span class="keywordflow">if</span> (conn-&gt;sem != SYS_SEM_NULL) {
00165     <a class="code" href="sys_8h.html#a10">sys_sem_signal</a>(conn-&gt;sem);
00166   }
00167 }
00168 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00169 <span class="keyword">static</span> <span class="keywordtype">void</span>
00170 setup_tcp(<span class="keyword">struct</span> <a class="code" href="structnetconn.html">netconn</a> *conn)
00171 {
00172   <span class="keyword">struct </span><a class="code" href="structtcp__pcb.html">tcp_pcb</a> *pcb;
00173   
00174   pcb = conn-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp;
00175   <a class="code" href="tcp_8h.html#a68">tcp_arg</a>(pcb, conn);
00176   <a class="code" href="tcp_8h.html#a70">tcp_recv</a>(pcb, recv_tcp);
00177   <a class="code" href="tcp_8h.html#a71">tcp_sent</a>(pcb, sent_tcp);
00178   <a class="code" href="tcp_8h.html#a72">tcp_poll</a>(pcb, poll_tcp, 4);
00179   <a class="code" href="tcp_8h.html#a73">tcp_err</a>(pcb, err_tcp);
00180 }
00181 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00182 <span class="keyword">static</span> <a class="code" href="err_8h.html#a13">err_t</a>
00183 accept_function(<span class="keywordtype">void</span> *arg, <span class="keyword">struct</span> <a class="code" href="structtcp__pcb.html">tcp_pcb</a> *newpcb, <a class="code" href="err_8h.html#a13">err_t</a> err)
00184 {
00185   sys_mbox_t mbox;
00186   <span class="keyword">struct </span><a class="code" href="structnetconn.html">netconn</a> *newconn;
00187   <span class="keyword">struct </span><a class="code" href="structnetconn.html">netconn</a> *conn;
00188   
00189 <span class="preprocessor">#if API_MSG_DEBUG</span>
00190 <span class="preprocessor"></span><span class="preprocessor">#if TCP_DEBUG</span>
00191 <span class="preprocessor"></span>  tcp_debug_print_state(newpcb-&gt;<a class="code" href="structtcp__pcb.html#o5">state</a>);
00192 <span class="preprocessor">#endif </span><span class="comment">/* TCP_DEBUG */</span>
00193 <span class="preprocessor">#endif </span><span class="comment">/* API_MSG_DEBUG */</span>
00194   conn = (<span class="keyword">struct </span><a class="code" href="structnetconn.html">netconn</a> *)arg;
00195   mbox = conn-&gt;acceptmbox;
00196   newconn = <a class="code" href="memp_8c.html#a7">memp_mallocp</a>(MEMP_NETCONN);
00197   <span class="keywordflow">if</span> (newconn == <a class="code" href="def_8h.html#a2">NULL</a>) {
00198     <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a1">ERR_MEM</a>;
00199   }
00200   newconn-&gt;type = <a class="code" href="api_8h.html#a46a2">NETCONN_TCP</a>;
00201   newconn-&gt;pcb.tcp = newpcb;
00202   setup_tcp(newconn);
00203   newconn-&gt;recvmbox = <a class="code" href="sys_8h.html#a17">sys_mbox_new</a>();
00204   <span class="keywordflow">if</span> (newconn-&gt;recvmbox == SYS_MBOX_NULL) {
00205     <a class="code" href="memp_8c.html#a8">memp_free</a>(MEMP_NETCONN, newconn);
00206     <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a1">ERR_MEM</a>;
00207   }
00208   newconn-&gt;mbox = <a class="code" href="sys_8h.html#a17">sys_mbox_new</a>();
00209   <span class="keywordflow">if</span> (newconn-&gt;mbox == SYS_MBOX_NULL) {
00210     <a class="code" href="sys_8h.html#a20">sys_mbox_free</a>(newconn-&gt;recvmbox);
00211     <a class="code" href="memp_8c.html#a8">memp_free</a>(MEMP_NETCONN, newconn);
00212     <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a1">ERR_MEM</a>;
00213   }
00214   newconn-&gt;sem = <a class="code" href="sys_8h.html#a9">sys_sem_new</a>(0);
00215   <span class="keywordflow">if</span> (newconn-&gt;sem == SYS_SEM_NULL) {
00216     <a class="code" href="sys_8h.html#a20">sys_mbox_free</a>(newconn-&gt;recvmbox);
00217     <a class="code" href="sys_8h.html#a20">sys_mbox_free</a>(newconn-&gt;mbox);
00218     <a class="code" href="memp_8c.html#a8">memp_free</a>(MEMP_NETCONN, newconn);
00219     <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a1">ERR_MEM</a>;
00220   }
00221   newconn-&gt;acceptmbox = SYS_MBOX_NULL;
00222   newconn-&gt;err = err;
00223   <span class="comment">/* Register event with callback */</span>
00224   <span class="keywordflow">if</span> (conn-&gt;callback)
00225   {
00226     (*conn-&gt;callback)(conn, <a class="code" href="api_8h.html#a48a12">NETCONN_EVT_RCVPLUS</a>, 0);
00227     <span class="comment">/* We have to set the callback here even though</span>
00228 <span class="comment">     * the new socket is unknown. Mark the socket as -1. */</span>
00229     newconn-&gt;callback = conn-&gt;callback;
00230     newconn-&gt;socket = -1;
00231   }
00232   
00233   <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(mbox, newconn);
00234   <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a0">ERR_OK</a>;
00235 }
00236 <span class="preprocessor">#endif </span><span class="comment">/* LWIP_TCP */</span>
00237 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00238 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00239"></a><a class="code" href="api__msg_8c.html#a2">00239</a> <a class="code" href="api__msg_8c.html#a2">do_newconn</a>(<span class="keyword">struct</span> <a class="code" href="structapi__msg__msg.html">api_msg_msg</a> *msg)
00240 {
00241 }
00242 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00243 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00244"></a><a class="code" href="api__msg_8c.html#a3">00244</a> <a class="code" href="api__msg_8c.html#a3">do_delconn</a>(<span class="keyword">struct</span> <a class="code" href="structapi__msg__msg.html">api_msg_msg</a> *msg)
00245 {
00246   <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp != <a class="code" href="def_8h.html#a2">NULL</a>) {
00247     <span class="keywordflow">switch</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o0">type</a>) {
00248 <span class="preprocessor">#if LWIP_UDP</span>
00249 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a4">NETCONN_UDPLITE</a>:
00250       <span class="comment">/* FALLTHROUGH */</span>
00251     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a5">NETCONN_UDPNOCHKSUM</a>:
00252       <span class="comment">/* FALLTHROUGH */</span>
00253     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a3">NETCONN_UDP</a>:
00254       msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp-&gt;recv_arg = <a class="code" href="def_8h.html#a2">NULL</a>;
00255       <a class="code" href="udp_8h.html#a8">udp_remove</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp);
00256       <span class="keywordflow">break</span>;
00257 <span class="preprocessor">#endif </span><span class="comment">/* LWIP_UDP */</span>
00258 <span class="preprocessor">#if LWIP_TCP      </span>
00259 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a2">NETCONN_TCP</a>:
00260       <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp-&gt;state == <a class="code" href="tcp_8h.html#a99a54">LISTEN</a>) {
00261   <a class="code" href="tcp_8h.html#a68">tcp_arg</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp, <a class="code" href="def_8h.html#a2">NULL</a>);
00262   <a class="code" href="tcp_8h.html#a69">tcp_accept</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp, <a class="code" href="def_8h.html#a2">NULL</a>);  
00263   <a class="code" href="tcp_8h.html#a79">tcp_close</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp);
00264       } <span class="keywordflow">else</span> {
00265   <a class="code" href="tcp_8h.html#a68">tcp_arg</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp, <a class="code" href="def_8h.html#a2">NULL</a>);
00266   <a class="code" href="tcp_8h.html#a71">tcp_sent</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp, <a class="code" href="def_8h.html#a2">NULL</a>);
00267   <a class="code" href="tcp_8h.html#a70">tcp_recv</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp, <a class="code" href="def_8h.html#a2">NULL</a>);  
00268   <a class="code" href="tcp_8h.html#a72">tcp_poll</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp, <a class="code" href="def_8h.html#a2">NULL</a>, 0);
00269   <a class="code" href="tcp_8h.html#a73">tcp_err</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp, <a class="code" href="def_8h.html#a2">NULL</a>);
00270   <span class="keywordflow">if</span> (<a class="code" href="tcp_8h.html#a79">tcp_close</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp) != <a class="code" href="err_8h.html#a0">ERR_OK</a>) {
00271     <a class="code" href="tcp_8h.html#a78">tcp_abort</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp);
00272   }
00273       }
00274 <span class="preprocessor">#endif</span>
00275 <span class="preprocessor"></span>    <span class="keywordflow">default</span>:  
00276     <span class="keywordflow">break</span>;
00277     }
00278   }
00279   <span class="comment">/* Trigger select() in socket layer */</span>
00280   <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o12">callback</a>)
00281   {
00282       (*msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o12">callback</a>)(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>, <a class="code" href="api_8h.html#a48a12">NETCONN_EVT_RCVPLUS</a>, 0);
00283       (*msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o12">callback</a>)(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>, <a class="code" href="api_8h.html#a48a14">NETCONN_EVT_SENDPLUS</a>, 0);
00284   }
00285   
00286   <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o6">mbox</a> != SYS_MBOX_NULL) {
00287     <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o6">mbox</a>, <a class="code" href="def_8h.html#a2">NULL</a>);
00288   }
00289 }
00290 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00291 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00292"></a><a class="code" href="api__msg_8c.html#a4">00292</a> <a class="code" href="api__msg_8c.html#a4">do_bind</a>(<span class="keyword">struct</span> <a class="code" href="structapi__msg__msg.html">api_msg_msg</a> *msg)
00293 {
00294   <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp == <a class="code" href="def_8h.html#a2">NULL</a>) {
00295     <span class="keywordflow">switch</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o0">type</a>) {
00296 <span class="preprocessor">#if LWIP_UDP</span>
00297 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a4">NETCONN_UDPLITE</a>:
00298       msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp = <a class="code" href="udp_8h.html#a7">udp_new</a>();
00299       <a class="code" href="udp_8h.html#a5">udp_setflags</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp, <a class="code" href="udp_8h.html#a2">UDP_FLAGS_UDPLITE</a>);
00300       <a class="code" href="udp_8h.html#a12">udp_recv</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp, recv_udp, msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>);
00301       <span class="keywordflow">break</span>;
00302     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a5">NETCONN_UDPNOCHKSUM</a>:
00303       msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp = <a class="code" href="udp_8h.html#a7">udp_new</a>();
00304       <a class="code" href="udp_8h.html#a5">udp_setflags</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp, <a class="code" href="udp_8h.html#a1">UDP_FLAGS_NOCHKSUM</a>);
00305       <a class="code" href="udp_8h.html#a12">udp_recv</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp, recv_udp, msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>);
00306       <span class="keywordflow">break</span>;
00307     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a3">NETCONN_UDP</a>:
00308       msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp = <a class="code" href="udp_8h.html#a7">udp_new</a>();
00309       <a class="code" href="udp_8h.html#a12">udp_recv</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp, recv_udp, msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>);
00310       <span class="keywordflow">break</span>;
00311 <span class="preprocessor">#endif </span><span class="comment">/* LWIP_UDP */</span>
00312 <span class="preprocessor">#if LWIP_TCP      </span>
00313 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a2">NETCONN_TCP</a>:
00314       msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp = <a class="code" href="tcp_8h.html#a66">tcp_new</a>();
00315       setup_tcp(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>);
00316 <span class="preprocessor">#endif </span><span class="comment">/* LWIP_TCP */</span>
00317     <span class="keywordflow">default</span>:  
00318     <span class="keywordflow">break</span>;
00319     }
00320   }
00321   <span class="keywordflow">switch</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o0">type</a>) {
00322 <span class="preprocessor">#if LWIP_UDP</span>
00323 <span class="preprocessor"></span>  <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a4">NETCONN_UDPLITE</a>:
00324     <span class="comment">/* FALLTHROUGH */</span>
00325   <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a5">NETCONN_UDPNOCHKSUM</a>:
00326     <span class="comment">/* FALLTHROUGH */</span>
00327   <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a3">NETCONN_UDP</a>:
00328     msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o5">err</a> = <a class="code" href="udp_8h.html#a9">udp_bind</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp, msg-&gt;<a class="code" href="structapi__msg__msg.html#o11">msg</a>.bc.ipaddr, msg-&gt;<a class="code" href="structapi__msg__msg.html#o11">msg</a>.bc.port);
00329     <span class="keywordflow">break</span>;
00330 <span class="preprocessor">#endif </span><span class="comment">/* LWIP_UDP */</span>
00331 <span class="preprocessor">#if LWIP_TCP</span>
00332 <span class="preprocessor"></span>  <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a2">NETCONN_TCP</a>:
00333     msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o5">err</a> = <a class="code" href="tcp_8h.html#a75">tcp_bind</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp,
00334             msg-&gt;<a class="code" href="structapi__msg__msg.html#o11">msg</a>.bc.ipaddr, msg-&gt;<a class="code" href="structapi__msg__msg.html#o11">msg</a>.bc.port);
00335 <span class="preprocessor">#endif </span><span class="comment">/* LWIP_TCP */</span>
00336   <span class="keywordflow">default</span>:
00337     <span class="keywordflow">break</span>;
00338   }
00339   <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o6">mbox</a>, <a class="code" href="def_8h.html#a2">NULL</a>);
00340 }
00341 <span class="preprocessor">#if LWIP_TCP</span>
00342 <span class="preprocessor"></span><span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00343 <span class="keyword">static</span> <a class="code" href="err_8h.html#a13">err_t</a>
00344 do_connected(<span class="keywordtype">void</span> *arg, <span class="keyword">struct</span> <a class="code" href="structtcp__pcb.html">tcp_pcb</a> *pcb, <a class="code" href="err_8h.html#a13">err_t</a> err)
00345 {
00346   <span class="keyword">struct </span><a class="code" href="structnetconn.html">netconn</a> *conn;
00347 
00348   conn = arg;
00349 
00350   <span class="keywordflow">if</span> (conn == <a class="code" href="def_8h.html#a2">NULL</a>) {
00351     <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a7">ERR_VAL</a>;
00352   }
00353   
00354   conn-&gt;err = err;
00355   <span class="keywordflow">if</span> (conn-&gt;type == <a class="code" href="api_8h.html#a46a2">NETCONN_TCP</a> &amp;&amp; err == <a class="code" href="err_8h.html#a0">ERR_OK</a>) {
00356     setup_tcp(conn);
00357   }    
00358   <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(conn-&gt;mbox, NULL);
00359   <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a0">ERR_OK</a>;
00360 }
00361 <span class="preprocessor">#endif  </span>
00362 <span class="preprocessor"></span><span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00363 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00364"></a><a class="code" href="api__msg_8c.html#a5">00364</a> <a class="code" href="api__msg_8c.html#a5">do_connect</a>(<span class="keyword">struct</span> <a class="code" href="structapi__msg__msg.html">api_msg_msg</a> *msg)
00365 {
00366   <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp == <a class="code" href="def_8h.html#a2">NULL</a>) {
00367     <span class="keywordflow">switch</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o0">type</a>) {
00368 <span class="preprocessor">#if LWIP_UDP</span>
00369 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a4">NETCONN_UDPLITE</a>:
00370       msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp = <a class="code" href="udp_8h.html#a7">udp_new</a>();
00371       <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp == <a class="code" href="def_8h.html#a2">NULL</a>) {
00372   msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o5">err</a> = <a class="code" href="err_8h.html#a1">ERR_MEM</a>;
00373   <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o6">mbox</a>, <a class="code" href="def_8h.html#a2">NULL</a>);
00374   <span class="keywordflow">return</span>;
00375       }
00376       <a class="code" href="udp_8h.html#a5">udp_setflags</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp, <a class="code" href="udp_8h.html#a2">UDP_FLAGS_UDPLITE</a>);
00377       <a class="code" href="udp_8h.html#a12">udp_recv</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp, recv_udp, msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>);
00378       <span class="keywordflow">break</span>;
00379     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a5">NETCONN_UDPNOCHKSUM</a>:
00380       msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp = <a class="code" href="udp_8h.html#a7">udp_new</a>();
00381       <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp == <a class="code" href="def_8h.html#a2">NULL</a>) {
00382   msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o5">err</a> = <a class="code" href="err_8h.html#a1">ERR_MEM</a>;
00383   <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o6">mbox</a>, <a class="code" href="def_8h.html#a2">NULL</a>);
00384   <span class="keywordflow">return</span>;
00385       }
00386       <a class="code" href="udp_8h.html#a5">udp_setflags</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp, <a class="code" href="udp_8h.html#a1">UDP_FLAGS_NOCHKSUM</a>);
00387       <a class="code" href="udp_8h.html#a12">udp_recv</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp, recv_udp, msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>);
00388       <span class="keywordflow">break</span>;
00389     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a3">NETCONN_UDP</a>:
00390       msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp = <a class="code" href="udp_8h.html#a7">udp_new</a>();
00391       <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp == <a class="code" href="def_8h.html#a2">NULL</a>) {
00392   msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o5">err</a> = <a class="code" href="err_8h.html#a1">ERR_MEM</a>;
00393   <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o6">mbox</a>, <a class="code" href="def_8h.html#a2">NULL</a>);
00394   <span class="keywordflow">return</span>;
00395       }
00396       <a class="code" href="udp_8h.html#a12">udp_recv</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp, recv_udp, msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>);
00397       <span class="keywordflow">break</span>;
00398 <span class="preprocessor">#endif </span><span class="comment">/* LWIP_UDP */</span>
00399 <span class="preprocessor">#if LWIP_TCP      </span>
00400 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a2">NETCONN_TCP</a>:
00401       msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp = <a class="code" href="tcp_8h.html#a66">tcp_new</a>();      
00402       <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp == <a class="code" href="def_8h.html#a2">NULL</a>) {
00403   msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o5">err</a> = <a class="code" href="err_8h.html#a1">ERR_MEM</a>;
00404   <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o6">mbox</a>, <a class="code" href="def_8h.html#a2">NULL</a>);
00405   <span class="keywordflow">return</span>;
00406       }
00407 <span class="preprocessor">#endif</span>
00408 <span class="preprocessor"></span>    <span class="keywordflow">default</span>:
00409       <span class="keywordflow">break</span>;
00410     }
00411   }
00412   <span class="keywordflow">switch</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o0">type</a>) {
00413 <span class="preprocessor">#if LWIP_UDP</span>
00414 <span class="preprocessor"></span>  <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a4">NETCONN_UDPLITE</a>:
00415     <span class="comment">/* FALLTHROUGH */</span>
00416   <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a5">NETCONN_UDPNOCHKSUM</a>:
00417     <span class="comment">/* FALLTHROUGH */</span>
00418   <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a3">NETCONN_UDP</a>:
00419     <a class="code" href="udp_8h.html#a10">udp_connect</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp, msg-&gt;<a class="code" href="structapi__msg__msg.html#o11">msg</a>.bc.ipaddr, msg-&gt;<a class="code" href="structapi__msg__msg.html#o11">msg</a>.bc.port);
00420     <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o6">mbox</a>, <a class="code" href="def_8h.html#a2">NULL</a>);
00421     <span class="keywordflow">break</span>;
00422 <span class="preprocessor">#endif </span>
00423 <span class="preprocessor"></span><span class="preprocessor">#if LWIP_TCP      </span>
00424 <span class="preprocessor"></span>  <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a2">NETCONN_TCP</a>:
00425     <span class="comment">/*    tcp_arg(msg-&gt;conn-&gt;pcb.tcp, msg-&gt;conn);*/</span>
00426     setup_tcp(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>);
00427     <a class="code" href="tcp_8h.html#a76">tcp_connect</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp, msg-&gt;<a class="code" href="structapi__msg__msg.html#o11">msg</a>.bc.ipaddr, msg-&gt;<a class="code" href="structapi__msg__msg.html#o11">msg</a>.bc.port,
00428     do_connected);
00429     <span class="comment">/*tcp_output(msg-&gt;conn-&gt;pcb.tcp);*/</span>
00430 <span class="preprocessor">#endif</span>
00431 <span class="preprocessor"></span>  <span class="keywordflow">default</span>:
00432     <span class="keywordflow">break</span>;
00433   }
00434 }
00435 
00436 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00437"></a><a class="code" href="api__msg_8c.html#a6">00437</a> <a class="code" href="api__msg_8c.html#a6">do_disconnect</a>(<span class="keyword">struct</span> <a class="code" href="structapi__msg__msg.html">api_msg_msg</a> *msg)
00438 {
00439 
00440   <span class="keywordflow">switch</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o0">type</a>) {
00441 <span class="preprocessor">#if LWIP_UDP</span>
00442 <span class="preprocessor"></span>  <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a4">NETCONN_UDPLITE</a>:
00443     <span class="comment">/* FALLTHROUGH */</span>
00444   <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a5">NETCONN_UDPNOCHKSUM</a>:
00445     <span class="comment">/* FALLTHROUGH */</span>
00446   <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a3">NETCONN_UDP</a>:
00447     <a class="code" href="udp_8h.html#a11">udp_disconnect</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp);
00448     <span class="keywordflow">break</span>;
00449 <span class="preprocessor">#endif </span>
00450 <span class="preprocessor"></span>  <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a2">NETCONN_TCP</a>:
00451     <span class="keywordflow">break</span>;
00452   }
00453   <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o6">mbox</a>, <a class="code" href="def_8h.html#a2">NULL</a>);
00454 }
00455 
00456 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00457 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00458"></a><a class="code" href="api__msg_8c.html#a7">00458</a> <a class="code" href="api__msg_8c.html#a7">do_listen</a>(<span class="keyword">struct</span> <a class="code" href="structapi__msg__msg.html">api_msg_msg</a> *msg)
00459 {
00460   <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp != <a class="code" href="def_8h.html#a2">NULL</a>) {
00461     <span class="keywordflow">switch</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o0">type</a>) {
00462 <span class="preprocessor">#if LWIP_UDP</span>
00463 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a4">NETCONN_UDPLITE</a>:
00464       <span class="comment">/* FALLTHROUGH */</span>
00465     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a5">NETCONN_UDPNOCHKSUM</a>:
00466       <span class="comment">/* FALLTHROUGH */</span>
00467     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a3">NETCONN_UDP</a>:
00468       <a class="code" href="debug_8h.html#a12">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a64">API_MSG_DEBUG</a>, (<span class="stringliteral">"api_msg: listen UDP: cannot listen for UDP.\n"</span>));
00469       <span class="keywordflow">break</span>;
00470 <span class="preprocessor">#endif </span><span class="comment">/* LWIP_UDP */</span>
00471 <span class="preprocessor">#if LWIP_TCP      </span>
00472 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a2">NETCONN_TCP</a>:
00473       msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp = <a class="code" href="tcp_8h.html#a77">tcp_listen</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp);
00474       <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp == <a class="code" href="def_8h.html#a2">NULL</a>) {
00475   msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o5">err</a> = <a class="code" href="err_8h.html#a1">ERR_MEM</a>;
00476       } <span class="keywordflow">else</span> {
00477   <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o8">acceptmbox</a> == SYS_MBOX_NULL) {
00478     msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o8">acceptmbox</a> = <a class="code" href="sys_8h.html#a17">sys_mbox_new</a>();
00479     <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o8">acceptmbox</a> == SYS_MBOX_NULL) {
00480       msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o5">err</a> = <a class="code" href="err_8h.html#a1">ERR_MEM</a>;
00481       <span class="keywordflow">break</span>;
00482     }
00483   }
00484   <a class="code" href="tcp_8h.html#a68">tcp_arg</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp, msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>);
00485   <a class="code" href="tcp_8h.html#a69">tcp_accept</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp, accept_function);
00486       }
00487 <span class="preprocessor">#endif</span>
00488 <span class="preprocessor"></span>    <span class="keywordflow">default</span>:
00489       <span class="keywordflow">break</span>;
00490     }
00491   }
00492   <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o6">mbox</a>, <a class="code" href="def_8h.html#a2">NULL</a>);
00493 }
00494 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00495 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00496"></a><a class="code" href="api__msg_8c.html#a8">00496</a> <a class="code" href="api__msg_8c.html#a8">do_accept</a>(<span class="keyword">struct</span> <a class="code" href="structapi__msg__msg.html">api_msg_msg</a> *msg)
00497 {
00498   <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp != <a class="code" href="def_8h.html#a2">NULL</a>) {
00499     <span class="keywordflow">switch</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o0">type</a>) {
00500 <span class="preprocessor">#if LWIP_UDP</span>
00501 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a4">NETCONN_UDPLITE</a>:
00502       <span class="comment">/* FALLTHROUGH */</span>
00503     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a5">NETCONN_UDPNOCHKSUM</a>:
00504       <span class="comment">/* FALLTHROUGH */</span>
00505     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a3">NETCONN_UDP</a>:    
00506       <a class="code" href="debug_8h.html#a12">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a64">API_MSG_DEBUG</a>, (<span class="stringliteral">"api_msg: accept UDP: cannot accept for UDP.\n"</span>));
00507       <span class="keywordflow">break</span>;
00508 <span class="preprocessor">#endif </span><span class="comment">/* LWIP_UDP */</span>
00509     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a2">NETCONN_TCP</a>:
00510       <span class="keywordflow">break</span>;
00511     }
00512   }
00513 }
00514 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00515 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00516"></a><a class="code" href="api__msg_8c.html#a9">00516</a> <a class="code" href="api__msg_8c.html#a9">do_send</a>(<span class="keyword">struct</span> <a class="code" href="structapi__msg__msg.html">api_msg_msg</a> *msg)
00517 {
00518   <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp != <a class="code" href="def_8h.html#a2">NULL</a>) {
00519     <span class="keywordflow">switch</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o0">type</a>) {
00520 <span class="preprocessor">#if LWIP_UDP</span>
00521 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a4">NETCONN_UDPLITE</a>:
00522       <span class="comment">/* FALLTHROUGH */</span>
00523     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a5">NETCONN_UDPNOCHKSUM</a>:
00524       <span class="comment">/* FALLTHROUGH */</span>
00525     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a3">NETCONN_UDP</a>:
00526       <a class="code" href="udp_8h.html#a13">udp_send</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.udp, msg-&gt;<a class="code" href="structapi__msg__msg.html#o11">msg</a>.p);
00527       <span class="keywordflow">break</span>;
00528 <span class="preprocessor">#endif </span><span class="comment">/* LWIP_UDP */</span>
00529     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a2">NETCONN_TCP</a>:
00530       <span class="keywordflow">break</span>;
00531     }
00532   }
00533   <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o6">mbox</a>, <a class="code" href="def_8h.html#a2">NULL</a>);
00534 }
00535 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00536 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00537"></a><a class="code" href="api__msg_8c.html#a10">00537</a> <a class="code" href="api__msg_8c.html#a10">do_recv</a>(<span class="keyword">struct</span> <a class="code" href="structapi__msg__msg.html">api_msg_msg</a> *msg)
00538 {
00539 <span class="preprocessor">#if LWIP_TCP</span>
00540 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp != <a class="code" href="def_8h.html#a2">NULL</a>) {
00541     <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o0">type</a> == <a class="code" href="api_8h.html#a46a2">NETCONN_TCP</a>) {
00542       <a class="code" href="tcp_8h.html#a74">tcp_recved</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp, msg-&gt;<a class="code" href="structapi__msg__msg.html#o11">msg</a>.len);
00543     }
00544   }
00545 <span class="preprocessor">#endif  </span>
00546 <span class="preprocessor"></span>  <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o6">mbox</a>, <a class="code" href="def_8h.html#a2">NULL</a>);
00547 }
00548 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00549 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00550"></a><a class="code" href="api__msg_8c.html#a11">00550</a> <a class="code" href="api__msg_8c.html#a11">do_write</a>(<span class="keyword">struct</span> <a class="code" href="structapi__msg__msg.html">api_msg_msg</a> *msg)
00551 {
00552 <span class="preprocessor">#if LWIP_TCP  </span>
00553 <span class="preprocessor"></span>  <a class="code" href="err_8h.html#a13">err_t</a> err;
00554 <span class="preprocessor">#endif  </span>
00555 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp != <a class="code" href="def_8h.html#a2">NULL</a>) {
00556     <span class="keywordflow">switch</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o0">type</a>) {
00557 <span class="preprocessor">#if LWIP_UDP </span>
00558 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a4">NETCONN_UDPLITE</a>:
00559       <span class="comment">/* FALLTHROUGH */</span>
00560     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a5">NETCONN_UDPNOCHKSUM</a>:
00561       <span class="comment">/* FALLTHROUGH */</span>
00562     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a3">NETCONN_UDP</a>:
00563       msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o5">err</a> = <a class="code" href="err_8h.html#a7">ERR_VAL</a>;
00564       <span class="keywordflow">break</span>;
00565 <span class="preprocessor">#endif </span><span class="comment">/* LWIP_UDP */</span>
00566 <span class="preprocessor">#if LWIP_TCP </span>
00567 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a2">NETCONN_TCP</a>:      
00568       err = <a class="code" href="tcp_8h.html#a80">tcp_write</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp, msg-&gt;<a class="code" href="structapi__msg__msg.html#o11">msg</a>.w.dataptr,
00569                       msg-&gt;<a class="code" href="structapi__msg__msg.html#o11">msg</a>.w.len, msg-&gt;<a class="code" href="structapi__msg__msg.html#o11">msg</a>.w.copy);
00570       <span class="comment">/* This is the Nagle algorithm: inhibit the sending of new TCP</span>
00571 <span class="comment">   segments when new outgoing data arrives from the user if any</span>
00572 <span class="comment">   previously transmitted data on the connection remains</span>
00573 <span class="comment">   unacknowledged. */</span>
00574       <span class="keywordflow">if</span> (err == <a class="code" href="err_8h.html#a0">ERR_OK</a> &amp;&amp; msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp-&gt;unacked == <a class="code" href="def_8h.html#a2">NULL</a>) {
00575   <a class="code" href="tcp_8h.html#a85">tcp_output</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp);
00576       }
00577       msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o5">err</a> = err;
00578       <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o12">callback</a>)
00579           <span class="keywordflow">if</span> (err == <a class="code" href="err_8h.html#a0">ERR_OK</a>)
00580           {
00581               <span class="keywordflow">if</span> (<a class="code" href="tcp_8h.html#a1">tcp_sndbuf</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp) &lt;= <a class="code" href="opt_8h.html#a39">TCP_SNDLOWAT</a>)
00582                   (*msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o12">callback</a>)(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>, <a class="code" href="api_8h.html#a48a15">NETCONN_EVT_SENDMINUS</a>, msg-&gt;<a class="code" href="structapi__msg__msg.html#o11">msg</a>.w.len);
00583           }
00584 <span class="preprocessor">#endif</span>
00585 <span class="preprocessor"></span>    <span class="keywordflow">default</span>:
00586       <span class="keywordflow">break</span>;
00587     }
00588   }
00589   <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o6">mbox</a>, <a class="code" href="def_8h.html#a2">NULL</a>);
00590 }
00591 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00592 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00593"></a><a class="code" href="api__msg_8c.html#a12">00593</a> <a class="code" href="api__msg_8c.html#a12">do_close</a>(<span class="keyword">struct</span> <a class="code" href="structapi__msg__msg.html">api_msg_msg</a> *msg)
00594 {
00595   <a class="code" href="err_8h.html#a13">err_t</a> err;
00596 
00597   err = <a class="code" href="err_8h.html#a0">ERR_OK</a>;
00598 
00599   <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp != <a class="code" href="def_8h.html#a2">NULL</a>) {
00600     <span class="keywordflow">switch</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o0">type</a>) {
00601 <span class="preprocessor">#if LWIP_UDP</span>
00602 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a4">NETCONN_UDPLITE</a>:
00603       <span class="comment">/* FALLTHROUGH */</span>
00604     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a5">NETCONN_UDPNOCHKSUM</a>:
00605       <span class="comment">/* FALLTHROUGH */</span>
00606     <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a3">NETCONN_UDP</a>:
00607       <span class="keywordflow">break</span>;
00608 <span class="preprocessor">#endif </span><span class="comment">/* LWIP_UDP */</span>
00609 <span class="preprocessor">#if LWIP_TCP</span>
00610 <span class="preprocessor"></span>    <span class="keywordflow">case</span> <a class="code" href="api_8h.html#a46a2">NETCONN_TCP</a>:
00611       <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp-&gt;state == <a class="code" href="tcp_8h.html#a99a54">LISTEN</a>) {
00612   err = <a class="code" href="tcp_8h.html#a79">tcp_close</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o4">pcb</a>.tcp);
00613       }
00614       msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o5">err</a> = err;      
00615 <span class="preprocessor">#endif</span>
00616 <span class="preprocessor"></span>    <span class="keywordflow">default</span>:      
00617       <span class="keywordflow">break</span>;
00618     }
00619   }
00620   <a class="code" href="sys_8h.html#a18">sys_mbox_post</a>(msg-&gt;<a class="code" href="structapi__msg__msg.html#o0">conn</a>-&gt;<a class="code" href="structnetconn.html#o6">mbox</a>, <a class="code" href="def_8h.html#a2">NULL</a>);
00621 }
00622 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
<a name="l00623"></a><a class="code" href="api__msg_8c.html#a0">00623</a> <span class="keyword">typedef</span> void (* <a class="code" href="api__msg_8c.html#a0">api_msg_decode</a>)(<span class="keyword">struct </span><a class="code" href="structapi__msg__msg.html">api_msg_msg</a> *msg);
<a name="l00624"></a><a class="code" href="api__msg_8c.html#a1">00624</a> <span class="keyword">static</span> <a class="code" href="api__msg_8c.html#a0">api_msg_decode</a> <a class="code" href="api__msg_8c.html#a1">decode</a>[<a class="code" href="api__msg_8h.html#a14a11">API_MSG_MAX</a>] = {
00625   <a class="code" href="api__msg_8c.html#a2">do_newconn</a>,
00626   <a class="code" href="api__msg_8c.html#a3">do_delconn</a>,
00627   <a class="code" href="api__msg_8c.html#a4">do_bind</a>,
00628   <a class="code" href="api__msg_8c.html#a5">do_connect</a>,
00629   <a class="code" href="api__msg_8c.html#a6">do_disconnect</a>,
00630   <a class="code" href="api__msg_8c.html#a7">do_listen</a>,
00631   <a class="code" href="api__msg_8c.html#a8">do_accept</a>,
00632   <a class="code" href="api__msg_8c.html#a9">do_send</a>,
00633   <a class="code" href="api__msg_8c.html#a10">do_recv</a>,
00634   <a class="code" href="api__msg_8c.html#a11">do_write</a>,
00635   <a class="code" href="api__msg_8c.html#a12">do_close</a>
00636   };
00637 <span class="keywordtype">void</span>
<a name="l00638"></a><a class="code" href="api__msg_8c.html#a13">00638</a> <a class="code" href="api__msg_8c.html#a13">api_msg_input</a>(<span class="keyword">struct</span> <a class="code" href="structapi__msg.html">api_msg</a> *msg)
00639 {  
00640   <a class="code" href="api__msg_8c.html#a1">decode</a>[msg-&gt;<a class="code" href="structapi__msg.html#o0">type</a>](&amp;(msg-&gt;<a class="code" href="structapi__msg.html#o1">msg</a>));
00641 }
00642 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00643 <span class="keywordtype">void</span>
<a name="l00644"></a><a class="code" href="api__msg_8c.html#a14">00644</a> <a class="code" href="api__msg_8c.html#a14">api_msg_post</a>(<span class="keyword">struct</span> <a class="code" href="structapi__msg.html">api_msg</a> *msg)
00645 {
00646   <a class="code" href="tcpip_8c.html#a6">tcpip_apimsg</a>(msg);
00647 }
00648 <span class="comment">/*-----------------------------------------------------------------------------------*/</span>
00649 
00650 
</pre></div>	</td>
  </tr>
</table>
<hr>
<div align="center">Copyright (c) 2001-2003 Swedish Institute of Computer Science</div>
</html>
